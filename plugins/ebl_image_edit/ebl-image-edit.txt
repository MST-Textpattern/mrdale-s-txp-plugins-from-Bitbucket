# ebl-image-edit 2.0
# Advanced Image Editing Plugin for Textpattern
# Eric Limegrover
# http://www.syserror.net/

# .....................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# .....................................................................

YTo5OntzOjQ6Im5hbWUiO3M6MTQ6ImVibC1pbWFnZS1lZGl0IjtzOjY6ImF1dGhvciI7czoxNToiRXJpYyBMaW1lZ3JvdmVyIjtzOjEwOiJhdXRob3JfdXJpIjtzOjI0OiJodHRwOi8vd3d3LnN5c2Vycm9yLm5ldC8iO3M6NzoidmVyc2lvbiI7czozOiIyLjAiO3M6MTE6ImRlc2NyaXB0aW9uIjtzOjQ1OiJBZHZhbmNlZCBJbWFnZSBFZGl0aW5nIFBsdWdpbiBmb3IgVGV4dHBhdHRlcm4iO3M6NDoiaGVscCI7czo2MDM2OiI8c3R5bGUgdHlwZT0idGV4dC9jc3MiID5oMSwgaDIsIGgzLCBwIHt0ZXh0LWFsaWduOmxlZnR9aDF7Zm9udC1zaXplOjI4cHg7IGxldHRlci1zcGFjaW5nOi4wMWVtOyB3b3JkLXNwYWNpbmc6LjFlbTsgY29sb3I6IzQ0NH1oMntmb250LXNpemU6MTRweDsgbWFyZ2luOjVweCAwIDE1cHg7IGNvbG9yOiNBQUE7IGJvcmRlci1ib3R0b206MXB4IHNvbGlkICNEREQ7IHBhZGRpbmc6MCAwIDVweDsgbGV0dGVyLXNwYWNpbmc6LjA1ZW07IHdvcmQtc3BhY2luZzouMWVtfWgze2ZvbnQtc2l6ZToxNnB4OyBtYXJnaW46MTBweCAwOyBjb2xvcjojNDQ0OyBmb250LXdlaWdodDogOTAwO31we21hcmdpbjoxNXB4IDA7IGZvbnQtc2l6ZToxNHB4OyBsaW5lLWhlaWdodDoyNHB4fS5kcm9wY2Fwe2Zsb2F0OmxlZnQ7IGNvbG9yOiNCNEI0Qjc7IGZvbnQtc2l6ZTo1MHB4OyBsaW5lLWhlaWdodDo0MHB4OyBwYWRkaW5nLXRvcDoycHg7IG1hcmdpbjowIDNweCAwIDA7IGZvbnQtZmFtaWx5OlRpbWVzLHNlcmlmLEdlb3JnaWF9LmNhcHN7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlOyBsZXR0ZXItc3BhY2luZzouMTVlbTsgZm9udC1zaXplOjEycHg7IGNvbG9yOiM1NTV9I21haW4ge2ZvbnQtZmFtaWx5Okdlb3JnaWEsICJUaW1lcyBOZXcgUm9tYW4iLCBUaW1lcywgc2VyaWY7IGZvbnQtc2l6ZToxNHB4O2ZvbnQtd2VpZ2h0OjQwMDt9CTwvc3R5bGU+DQoNCjxkaXYgaWQ9Im1haW4iPg0KPGgxPkVCTCBJbWFnZSBFZGl0PC9oMT4NCiA8aDI+QWR2YW5jZWQgSW1hZ2UgRWRpdGluZyBQbHVnaW4gZm9yIFRleHRwYXR0ZXJuPC9oMj4NCiA8cD48c3BhbiBjbGFzcz0iZHJvcGNhcCI+VDwvc3Bhbj5oaXMgcGx1Z2luIGludHJvZHVjZXMgYWR2YW5jZWQgaW1hZ2UgZWRpdGluZyBmdW5jdGlvbmFsaXR5IHRvIFRleHRwYXR0ZXJuIDQuMDcgLyA0LjA4LiANCiBVc2VycyBtYXkgbm93IGN1c3RvbSBjcm9wLCByZXNpemUsIHJvdGF0ZSwgYW5kIGNyZWF0ZSBjdXN0b20gdGh1bWJuYWlscyBkaXJlY3RseSB3aXRoaW4gVGV4dHBhdHRlcm4uPC9wPg0KDQogPGgzPkZlYXR1cmVzPC9oMz4NCiA8cD5UaGlzIHBsdWdpbiBhbGxvd3MgZm9yIGZ1bmN0aW9ucyBwcmV2aW91c2x5IG9ubHkgYXZhaWxhYmxlIGluIGltYWdlLWVkaXRpbmcgcHJvZ3JhbWlucy4gSXQgYWxsb3dzIGZvciB1c2VycywgYXQgYW55IHRlcm1pbmFsIHdoaWNoIHRoZXkncmUgbG9nZ2VkIGluIHRvIHRvIGRvIHRoZSBmb2xsb3dpbmc6IA0KIDx1bD4NCiAJPGxpPjxzdHJvbmc+Q3JvcHBpbmc8L3N0cm9uZz46IFRoZSBvcmlnaW5hbCB1cGxvYWRlZCBpbWFnZSBjYW4gYmUgZWRpdGVkIHRvIGN1dCBvdXQgcGFydHMgdGhhdCBhcmUgbm90IGRlc2lyZWQgYW5kIGtlZXAgb25seSB0aG9zZSBpbXBvcnRhbnQgZmFjZXRzIG9mIHRoZSBvcmlnaW5hbCBpbWFnZS48L2xpPg0KIAk8bGk+PHN0cm9uZz5UaHVtYm5haWwgQ3JvcDwvc3Ryb25nPjogTWFrZSBhIHRodW1ibmFpbCBzaG93IG5vdCB0aGUgZW50aXJlIGltYWdlLCBidXQganVzdCBlbm91Z2ggdG8gcGlxdWUgaW50ZXJlc3QuPC9saT4NCiAJPGxpPjxzdHJvbmc+Um90YXRlPC9zdHJvbmc+OiBGb3IgdGhvc2UgcGljdHVyZXMgdGhhdCBhcmUgc2lkZXdheXMgb3IgdXBzaWRlIGRvd24uIFVzZXJzIG1heSByb3RhdGUgdGhlIGltYWdlIGNsb2Nrd2lzZTkwJmRlZzssIGNvdW50ZXJjbG9ja3dpc2U5MCZkZWc7IG9yIHJvdGF0ZSBhIGZ1bGwgMTgwOTAmZGVnOy48L2xpPg0KIAk8bGk+PHN0cm9uZz5SZXNpemU8L3N0cm9uZz46IE1hbnkgZGlnaXRhbCBpbWFnZXMgYXJlIGp1c3QgdG9vIGxhcmdlIHRvIGJlIHNob3duIG9uIHRoZSB3ZWIuIFRoaXMgb3B0aW9uIGFsbG93cyBmb3IgZXhjZXNzaXZlbHkgc2l6ZWQgaW1hZ2VzIHRvIGJlIHNjYWxlZCBkb3duLiBCdWlsdCBpbnRvIHRoZSByZXNpemluZyBmdW5jdGlvbiBpcyB0aGUgYWJpbGl0eSB0byBtYWludGFpbiB0aGUgb3JpZ2luYWwgaGVpZ2h0IHRvIHdpZHRoIHJhdGlvLCBzbyBpbWFnZXMgd2lsbCBuZXZlciBzZWVtIHNxdWlzaGVkIG9uZSB3YXkgb3IgdGhlIG90aGVyLjwvbGk+DQogCTxsaT48c3Ryb25nPkltYWdlIEJhY2t1cHM8L3N0cm9uZz46IE5ldyBmb3IgPGk+Mi4wPC9pPiBpcyB0aGUgZmVhdHVyZSB0byBzYXZlIGFuIG9yaWdpbmFsIGNvcHkgb2YgdGhlIHRoZSBpbWFnZSB0byBhIHRlbXAgZm9sZGVyIHNvIHRoYXQgeW91IG1heSByZXN0b3JlIGl0IGF0IGFueSB0aW1lLiBUaGUgaW1hZ2UgbXVzdCBmaXJzdCBiZSBzYXZlZCBieSBjbGlja2luZyBvbiBiYWNrdXAsIGFuZCB0aGVuIG1heSBiZSByZXN0b3JlZCBhdCBhbnkgdGltZS48L2xpPg0KIDwvdWw+PC9wPg0KIDxoMz5JbnN0YWxsYXRpb248L2gzPg0KIDxwPkluc3RhbGxhdGlvbiBpcyBzdHJhaWdodCBmb3J3YXJkIGFuZCBpbnZvbHZlcyB0aGUgaW5zdGFsbGF0aW9uIG9mIG9uZSBwbHVnaW4gZmlsZSwgYW5kIHRoZSB1cGxvYWQgb2Ygb25lIGRpcmVjdG9yeSB0byB5b3VyIFRleHRwYXR0ZXJuIGZvbGRlci48L3A+DQogPHA+Q29udGFpbmVkIHdpdGhpbiB0aGUgemlwIGFyY2hpdmUgYXJlIHR3byBmaWxlczoNCiAgPG9sPg0KICAgPGxpPjxiPmVibC1pbWFnZS1lZGl0X3YxLjAudHh0PC9iPiA6IFRoaXMgaXMgdGhlIHBsdWdpbiBjb2RlIHRoYXQgaXMgcGFzdGVkIGludG8gdGhlIHRleHRib3ggaW4gPGk+QWRtaW4gLT4gUGx1Z2luczwvaT48L2xpPg0KICAgPGxpPjxiPmpjcm9wPC9iPiA6IFRoaXMgZm9sZGVyIHdpbGwgbmVlZCB0byBiZSB1cGxvYWRlZCB0byB0aGUgVGV4dHBhdHRlcm4gZGlyZWN0b3J5IChlLmcuLCAvdGV4dHBhdHRlcm4vICk8L2xpPg0KICA8L29sPg0KIDwvcD4NCiA8cD5PbmNlIHRoZSBhYm92ZSBoYXMgYmVlbiBjb21wbGV0ZWQsIGFjdGl2YXRlIHRoZSBwbHVnaW4gaW4gPGk+QWRtaW4gLT4gUGx1Z2luczwvaT48L3A+DQogPHA+T25jZSB0aGUgcGx1Z2luIGhhcyBiZWVuIGFjdGl2YXRlZCwgbmF2aWdhdGUgdG8gPGk+Q29udGVudCAtPiBFeHRlbnNpb25zIC0+IEVCTCBJbWFnZSBFZGl0PC9pPi4gVGhlIHRlbXAgZm9sZGVyIGFuZCBkYiBmaWVsZCB3aWxsIGJlIGNyZWF0ZWQuIFRoZSBwbHVnaW4gd2lsbCBiZSByZWFkeSBmb3IgdXNlIGF0IHRoaXMgcG9pbnQuPC9wPiANCiAgDQogPGgzPlVzYWdlIEluc3RydWN0aW9uczwvaDM+DQogPHA+RnVydGhlciBoZWxwIGNhbiBiZSBmb3VuZCBvbmxpbmUgaW4gdGhlIHRleHRwYXR0ZXJuIGZvcnVtIHRvcGljOiAiPHN0cm9uZz48YSBocmVmPSJodHRwOi8vZm9ydW0udGV4dHBhdHRlcm4uY29tL3ZpZXd0b3BpYy5waHA/aWQ9Mjk1NDciPmVibCBpbWFnZSBlZGl0IHYxLjAgPC9hPjwvc3Ryb25nPiI8L3A+DQogPHVsPg0KIAk8bGk+PGI+Q3JvcDwvYj46IFRoaXMgdGFiIHBlcm1pdHMgdGhlIGNyb3BwaW5nIG9mIGltYWdlcy4gQ2xpY2sgYW5kIGRyYWcgYWNyb3NzIHRoZSBpbWFnZSB0byBzZWxlY3QgdGhlIGNyb3AgYXJlYS4gV2hpbGUgc2VsZWN0aW5nIHRoZSBjcm9wIHJlZ2lvbiwgdGhlIHNpemUgb2YgdGhlIGNyb3AgYXJlYSB3aWxsYmUgZGlzcGxheWVkIGluIGFzIFdpZHRoIFggSGVpZ2h0LiBUaGlzIGlzIG1lYXN1cmVkIGluIHBpeGVscy4gWW91J2xsIG5vdGUgdGhhdCB0aGUgYXJlYSBvdXRzaWRlIG9mIHRoZSBjcm9wIHJlZ2lvbiBpcyBkYXJrLCB3aGVyZWFzIHRoZSBhcmVhIGluc2lkZSBpcyBsaWdodGVyLiBUaGlzIGlzIHRoZSBpbnRlbmRlZCBlZmZlY3QuIEV2ZXJ5dGhpbmcgd2l0aGluIHRoZSBjcm9wIGFyZWEgd2lsbCBiZSBzZWxlY3RlZCBhbmQgd2lsbCByZXBsYWNlIHRoZSBvcmlnaW5hbCBpbWFnZSBvbmNlIHRoZSA8Yj5Dcm9wIE9yaWdpbmFsPC9iPiBidXR0b24gaXMgY2xpY2tlZC4NCgk8dWw+DQoJCTxsaT48aT5QcmVkZWZpbmVkIHNpemU8L2k+OiBUaGlzIGRyb3AtZG93biBib3ggYWxsb3dzIHRoZSB1c2VyIHRvIHNlbGVjdCBwcmUtZGVmaW5lZCBjcm9wIGFyZWEgc2VsZWN0aW9ucy4gVGhleSBtYXkgYmUgbW92ZWQgYXJvdW5kIGFueXdoZXJlIG9uIHRoZSBpbWFnZS4gSWYgbmVlZGVkLCB0aGVzZSBhcmVhcyBjYW4gYmUgc2l6ZWQgZGlmZmVyZW50bHksIGJ1dCB0aGUgYXNwZWN0IHJhdGlvIG9mIHRoZSBvcmlnaW5hbCB3aWxsIHJlbWFpbi4gPGk+KEZvdW5kIGluIFRodW1ibmFpbCBDcm9wIGFzIHdlbGwuKTwvaT48bGk+DQoJCTxsaT48aT5Mb2NrIEFzcGVjdCBSYXRpbzwvaT46IFVuY2hlY2tpbmcgdGhpcyBib3ggd2lsbCBhbGxvdyBmb3IgYSBkaWZmZXJlbnQgYXNwZWN0IHJhdGlvIHRoYW4gd2hhdCB3YXMgc2VsZWN0ZWQgaW4gdGhlIGRyb3AgZG93biBib3guIDxpPihGb3VuZCBpbiBUaHVtYm5haWwgQ3JvcCBhcyB3ZWxsLik8L2k+PC9saT4NCgk8L3VsPjwvbGk+DQogCTxsaT48Yj5UaHVtYm5haWwgQ3JvcDwvYj46IE5lYXJseSBpZGVudGljYWwgaW4gZnVuY3Rpb24gdG8gdGhlIG1haW4gaW1hZ2UgY3JvcCwgdGhlIHRodW1ibmFpbCBjcm9wIGFsbG93cyBmb3IgYSBzZWxlY3RlZCByZWdpb24gdG8gYmUgaGlnaGxpZ2h0ZWQgdG8gYWN0IGFzIHRoZSBwcmltYXJ5IGltYWdlIHRodW1ibmFpbC4gVG8gY3JlYXRlIHRoZSBjcm9wcGVkIHRodW1ibmFpbCwgc2VsZWN0IHRoZSBjcm9wLWFyZWEuIElmIHlvdSB3YW50IHRoZSBpbWFnZSByZXNpemVkIHRvIGEgc3BlY2lmaWMgZGltZW5zaW9uLCBjaGVjayA8aT5SZXNpemUgVGh1bWJuYWlsPC9pPiBhbmQgZWRpdCB0aGUgc2l6ZSBhY2NvcmRpbmdseS4gT25jZSB5b3UgYXJlIHNhdGlzaWZpZWQgd2l0aCB0aGUgY3JvcCBhcmVhIGFuZCB0aGUgb3B0aW9ucywgY2xpY2sgb24gdGhlIENyZWF0ZSBUaHVtYm5haWwgYnV0dG9uLiA8L2xpPg0KIAk8bGk+PGI+Um90YXRlPC9iPjogVGhpcyB0YWIgYWxsb3dzIHRocmVlIHNlcGVyYXRlIG1ldGhvZHMgb2Ygcm90YXRpbmcuIDEuIFJvdGF0ZSBDbG9ja3dpc2UgOTAmZGVnOyAoVHVybiBSaWdodCksIDIuIENvdW50ZXItQ2xvY2t3aXNlIDkwJmRlZzsgKExlZnQgVHVybikgb3IgMy4gMTgwJmRlZzsgKEZsaXApLiBDbGlja2luZyBhbnkgb2YgdGhlc2UgYnV0dG9ucyB3aWxsIHJvdGF0ZSB0aGUgb3JpZ2luYWwgYnV0dG9uLiA8ZW0+RG8gbm90IHJlcGVhdGVkbHkgcm90YXRlIHRoZSBpbWFnZXMgYXMgdGhpcyB3aWxsIGdyYWR1YWxseSBkZWdyYWRlIGltYWdlIHF1YWxpdHk8L2VtPi48L2xpPg0KIAk8bGk+PGI+UmVzaXplPC9iPjogVGhpcyB0YWIgYWxsb3dzIHRoZSBmb3IgYSBsb25nZXN0LXNpZGUgcmVzaXplIG9mIGFuIG9yaWdpbmFsIGltYWdlLiBTaW1wbHkgaW5wdXQgdGhlIGRlc2lyZWQgZGltZW5zaW9ucyBhbmQgdGhlIGltYWdlIHdpbGwgYmUgc2l6ZWQgZG93biB0byBmaXQuIE5vdGUsIGlmIHRoZSBpbWFnZSBpcyBzbWFsbGVyIGluIGFueSBvbmUgZGltZW5zaW9uIHRoYXQgd2hpY2ggd2FzIGVudGVyZWQsIGl0IHdpbGwgbm90IGJlIHNpemVkIHVwIHRvIGZpdCwgYnV0IHJhdGhlciwgc2l6ZWQgZG93biBpbiBwcm9wb3J0aW9uIHdpdGggdGhlIGxvbmdlc3Qgc2lkZS4gSWYgdGhlIGltYWdlIGlzIGVudGlyZWx5IHNtYWxsZXIgdGhhbiB0aGUgZGltZW5zaW9ucyBlbnRlcmVkLCBpdCB3aWxsIG5vdCBiZSByZXNpemVkLiA8L2xpPg0KCTxsaT48Yj5CYWNrdXA8L2I+OiBUaGlzIHRhYiBhbGxvd3MgZm9yIHRoZSBiYWNraW5nLXVwIG9mIGFuIGltYWdlIGludG8gYSBiYWNrdXAgZm9sZGVyIGxvY2F0ZWQgd2l0aGluIHlvdXIgaW1hZ2UgZGlyZWN0b3J5LiBXaGVuIGFjdGl2ZSwgdHdvIGJ1dHRvbnMgYXJlIGRpc3BsYXllZC4gVGhlIGZpcnN0LCBCYWNrdXAgd2lsbCBpbW1lZGlhdGVseSBjb3B5IHRoZSBhc3NvY2lhdGVkIGltYWdlIHRvIHRoZSBiYWNrdXAgZGlyZWN0b3J5IGFuZCBvdmVyd3JpdGUgYW55IGlkZW50aWNhbGx5IG5hbWVkIGZpbGUuIENsaWNraW5nIFJlc3RvcmUgd2lsbCBjb3B5IHRoYXQgaW1hZ2UgYmFjayB0byB0aGUgbWFpbiBpbWFnZSBkaXJlY3RvcnkgYnV0IHdpbGwgc3RpbGwgbWFpbnRhaW4gdGhlIGNvcGllZCBmaWxlIGluIHRoaXMgbG9jYXRpb24uPC9saT4NCiA8L3VsPjwvcD4NCjwvZGl2Pg0KDQo8L2Rpdj4iO3M6NDoiY29kZSI7czoyNzU1OToiaWYgKEB0eHBpbnRlcmZhY2UgPT0gJ2FkbWluJykNCgl7DQoJCWFkZF9wcml2cygnZWJsaW1nZWRpdGV4dCcsICcxJyk7IA0KCQlyZWdpc3Rlcl90YWIoImV4dGVuc2lvbnMiLCAiZWJsaW1nZWRpdGV4dCIsICJFQkwgSW1hZ2UgRWRpdCIpOw0KCQlyZWdpc3Rlcl9jYWxsYmFjaygiZWJsX2ltYWdlX2VkaXRfZXh0IiwgImVibGltZ2VkaXRleHQiKTsNCg0KCXN3aXRjaCAoZ3BzKCdldmVudCcpKQ0KCXsNCgkJY2FzZSAnZWJscm90YXRlbGVmdCc6DQoJCQllYmxfaW1nX2VkaXQoZ3BzKCdpbWdpZCcpLCAnbGVmdCcsICdyb3RhdGUnKTsgZXhpdCgpOw0KCQkJYnJlYWs7DQoJCWNhc2UgJ2VibHJvdGF0ZXJpZ2h0JzoNCgkJCWVibF9pbWdfZWRpdChncHMoJ2ltZ2lkJyksICdyaWdodCcsICdyb3RhdGUnKTsgZXhpdCgpOw0KCQkJYnJlYWs7DQoJCWNhc2UgJ2VibHJvdGF0ZXVwJzoNCgkJCWVibF9pbWdfZWRpdChncHMoJ2ltZ2lkJyksICd1cCcsICdyb3RhdGUnKTsgZXhpdCgpOw0KCQkJYnJlYWs7DQoJCWNhc2UgJ2VibGltZ2Nyb3AnOg0KCQkJZWJsX2ltZ19lZGl0KGdwcygnaW1naWQnKSwgJycsICdjcm9wJyk7IGV4aXQoKTsNCgkJCWJyZWFrOw0KCQljYXNlICdlYmxpbWdjcm9wJzoNCgkJCWVibF9wcm9jZXNzVXBsb2FkKGdwcygndXBsb2FkVHlwZScpKTsNCgkJCWJyZWFrOw0KCQljYXNlICdlYmx0bWJjcm9wJzoNCgkJCWVibF9pbWdfZWRpdChncHMoJ2ltZ2lkJyksICcnLCAndGh1bWJuYWlsJyk7IGV4aXQoKTsNCgkJCWJyZWFrOw0KCQljYXNlICdlYmxyc3ppbWcnOg0KCQkJZWJsX2ltZ19lZGl0KGdwcygnaW1naWQnKSwgJycsICdyc3onKTsgZXhpdCgpOw0KCQkJYnJlYWs7DQoJCWNhc2UgJ2VibGJhY2t1cGltZyc6DQoJCQllYmxiYWNrdXBpbWcoZ3BzKCdpbWdpZCcpKTsNCgkJCWJyZWFrOw0KCQljYXNlICdlYmxyZXN0b3JlaW1nJzoNCgkJCWVibHJlc3RvcmVpbWcoZ3BzKCdpbWdpZCcpKTsNCgkJCWJyZWFrOw0KCX0NCn0NCg0KZnVuY3Rpb24gZWJsX2ltYWdlX2VkaXRfZXh0KCkgDQp7DQoJDQoJJHN0ZXAgPSBncHMoJ3N0ZXAnKTsNCgkNCgkkbWVzc2FnZSA9IChpc19jYWxsYWJsZSgkc3RlcCkpID8gJHN0ZXAoKSA6ICcnOw0KCQ0KCWVjaG8gcGFnZXRvcCgiRUJMIEltYWdlIEVkaXQgUHJlZmVyZW5jZXMiLCAkbWVzc2FnZSk7DQoJDQoJZWNobyAJJzxkaXYgc3R5bGU9Im1hcmdpbjogMCBhdXRvOyB3aWR0aDogNDAwcHg7Ij4nLm4uDQoJCQllYmxfbGlzdF9jcm9wU3R5bGVzKCkuDQoJCQknPC9kaXY+JzsJDQp9DQoNCmZ1bmN0aW9uIGVibF9saXN0X2Nyb3BTdHlsZXMoKQ0Kew0KCWdsb2JhbCAkdHhwX3VzZXIsICRwYXRoX3RvX3NpdGUsICRpbWdfZGlyOw0KCQ0KCSRiYWNrdXBkaXIgCT0gJHBhdGhfdG9fc2l0ZSAuICcvJyAuICRpbWdfZGlyIC4gJy9iYWNrdXAvJzsNCgkJaWYoIWZpbGVfZXhpc3RzKCRiYWNrdXBkaXIpKSB7DQoJCQkNCgkJJGNyZWF0ZUVCTHRhYmxlID0gc2FmZV9xdWVyeSgiQ1JFQVRFIFRBQkxFIGAiLlBGWC4iZWJsX2Nyb3BgICgiLg0KCQkJCQkJCQkJImBuYW1lYCB2YXJjaGFyKDY0KSBOT1QgTlVMTCwiLg0KCQkJCQkJCQkJImB3aWR0aGAgdmFyY2hhcigxNikgTk9UIE5VTEwsIi4NCgkJCQkJCQkJCSJgaGVpZ2h0YCB2YXJjaGFyKDE2KSBOT1QgTlVMTCwiLg0KCQkJCQkJCQkJImB0aHVtYmAgdmFyY2hhcigxKSBOT1QgTlVMTCBkZWZhdWx0ICcwJywiLg0KCQkJCQkJCQkJIlVOSVFVRSBLRVkgYG5hbWVgIChgbmFtZWApIi4NCgkJCQkJCQkJCSIpOyIpOw0KCQkJCQkJCQkJDQoJCSRycyA9IHNhZmVfaW5zZXJ0KCdlYmxfY3JvcCcsICJgbmFtZWAgPSAnSW1hZ2UgQ3JvcCcsIGB3aWR0aGAgPSAnNTAwJyxgaGVpZ2h0YCA9ICc1MDAnLCBgdGh1bWJgID0gJzAnIik7DQoJCSRycyA9IHNhZmVfaW5zZXJ0KCdlYmxfY3JvcCcsICJgbmFtZWAgPSAnVGh1bWJuYWlsIFNxdWFyZScsIGB3aWR0aGAgPSAnMTAwJyxgaGVpZ2h0YCA9ICcxMDAnLCBgdGh1bWJgID0gJzEnIik7DQoNCgkJCSRta2RpciA9IChAbWtkaXIoJGJhY2t1cGRpcikpID8gVFJVRSA6IEZBTFNFOw0KCQkJaWYoJG1rZGlyKSB7IA0KCQkJCWVjaG8gIjxwICBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgXCI+JGJhY2t1cGRpciBkaWQgbm90IGV4aXN0IHByZXZpb3VzbHkuIE5vdyBjcmVhdGVkLjwvcD4iOw0KCQkJfSBlbHNlIHsNCgkJCQllY2hvICI8cCBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgZm9udC13ZWlnaHQ6IGJvbGQ7IFwiPlVuYWJsZSB0byBjcmVhdGUgJGJhY2t1cGRpci4gUGxlYXNlIGNoZWNrIHlvdXIgZm9sZGVyIHBlcm1pc3Npb25zLjwvcD4iOw0KCQkJfQ0KCQl9DQoNCg0KIA0KCWVjaG8gbi5uLmhlZChnVHh0KCdDcm9wIFN0eWxlcycpLCAxLCAnIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6MmVtOyBmb250LXdlaWdodDogYm9sZDsiJykuDQoJCW4ubi5zdGFydFRhYmxlKCdsaXN0JykuDQoJCW4udHIoDQoJCQluLmhDZWxsKGdUeHQoJ25hbWUnKSkuDQoJCQluLmhDZWxsKGdUeHQoJ3dpZHRoJykpLg0KCQkJbi5oQ2VsbCgpLg0KCQkJbi5oQ2VsbChnVHh0KCdoZWlnaHQnKSkuDQoJCQluLmhDZWxsKGdUeHQoJ3RodW1ibmFpbCcpKS4NCgkJCW4uaENlbGwoZ1R4dCgnZGVsZXRlJykpDQoJCSk7DQoNCgkkcnMgPSBzYWZlX3Jvd3Nfc3RhcnQoJyonLCAnZWJsX2Nyb3AnLCAnMT0xIE9SREVSIEJZIGBuYW1lYCcpOw0KDQoJJG91dCA9ICcnOw0KCQ0KCWlmICgkcnMpDQoJeyANCgkJd2hpbGUgKCRhID0gbmV4dFJvdygkcnMpKQ0KCQl7IA0KCQkJJGlzQ2hlY2tlZCA9ICgkYVsndGh1bWInXSA9PSAxKSA/ICd5ZXMnIDogJ25vJzsNCgkJCSRvdXQgLj0gbi50cigNCgkJCQkJdGQoIGh0bWxzcGVjaWFsY2hhcnMoJGFbJ25hbWUnXSkpLg0KCQkJCQl0ZCggaHRtbHNwZWNpYWxjaGFycygkYVsnd2lkdGgnXSkpLg0KCQkJCQl0ZCggaHRtbHNwZWNpYWxjaGFycygnIFggJykpLg0KCQkJCQl0ZCggaHRtbHNwZWNpYWxjaGFycygkYVsnaGVpZ2h0J10pKS4NCgkJCQkJdGQoICRpc0NoZWNrZWQpLg0KCQkJCQl0ZCggDQoJCQkJCQlkTGluaygnZWJsaW1nZWRpdGV4dCcsICdlYmxfY3JvcGRlbGV0ZScsICdzdHlsZW5hbWUnLCAkYVsnbmFtZSddKQ0KCQkJCQkpDQoJCQkJKTsNCgkJfQ0KCX0NCgkNCgllY2hvIGZvcm0oJG91dCk7DQoJDQoJZWNobyBuLnRyKA0KCQlmb3JtKA0KCQkJdGQoIGZJbnB1dCgndGV4dCcsICduYW1lJywgJycsICdlZGl0JywnJywnJywxMCkgKS4NCgkJCXRkKCBmSW5wdXQoJ3RleHQnLCAnd2lkdGgnLCAnJywgJ2VkaXQnLCcnLCcnLDUpICkuDQoJCQl0ZCgpLg0KCQkJdGQoIGZJbnB1dCgndGV4dCcsICdoZWlnaHQnLCAnJywgJ2VkaXQnLCcnLCcnLDUpICkuDQoJCQl0ZCggJzxpbnB1dCBuYW1lPSJlYmxpc3RtYiIgY2xhc3M9ImNoZWNrYm94IiB0eXBlPSJjaGVja2JveCI+JykuDQoJCQl0ZCggZklucHV0KCdzdWJtaXQnLCAnYWRkJywgZ1R4dCgnYWRkJyksICdzbWFsbGVyYm94JykgKS4NCgkJCW4uZUlucHV0KCdlYmxpbWdlZGl0ZXh0JykuDQoJCQluLnNJbnB1dCgnZWJsX2Nyb3BzYXZlbmV3JykNCgkJKQ0KCSk7DQoNCgllY2hvIG4uZW5kVGFibGUoKTsNCn0NCg0KZnVuY3Rpb24gc2VsZWN0U3R5bGVzKCR0aHVtYiA9ICcwJykgew0KDQoJJHJzID0gc2FmZV9yb3dzX3N0YXJ0KCcqJywgJ2VibF9jcm9wJywgJ3RodW1iPScuJHRodW1iLicgT1JERVIgQlkgYG5hbWVgJyk7DQoNCgkkb3V0ID0gIjxzZWxlY3QgbmFtZT1cImN1c3RvbXNpemVcIiBpZD1cImN1c3RvbXNpemUkdGh1bWJcIj4nICsgIi5uLg0KCQkgICAiJzxvcHRpb24gdmFsdWU9XCJDdXN0b21cIj5DdXN0b208L29wdGlvbj4nICsgIi5uOw0KCQ0KCWlmICgkcnMpDQoJeyANCgkJd2hpbGUgKCRhID0gbmV4dFJvdygkcnMpKQ0KCQl7DQoJCQkkd2lkdGgJPSAkYVsnd2lkdGgnXTsNCgkJCSRoZWlnaHQJPSAkYVsnaGVpZ2h0J107DQoJCQkkbmFtZSAJPSAkYVsnbmFtZSddOw0KDQoJCQkkb3V0IC49ICInPG9wdGlvbiB2YWx1ZT0iLiR3aWR0aC4ieCIuJGhlaWdodC4iXD4iLmh0bWxzcGVjaWFsY2hhcnMoJG5hbWUpLiIgOiAkd2lkdGggeCAkaGVpZ2h0IDwvb3B0aW9uPicgKyAiLm47DQoJCX0NCgl9DQoJJG91dCAuPSAiJzwvc2VsZWN0PiI7DQoJDQoJcmV0dXJuICRvdXQ7DQp9DQpmdW5jdGlvbiBlYmxfY3JvcHNhdmVuZXcoKQ0Kew0KDQoJZXh0cmFjdChkb1NsYXNoKHBzYShhcnJheSgnbmFtZScsICd3aWR0aCcsJ2hlaWdodCcsJ2VibGlzdG1iJykpKSk7DQoJDQoJaWYgKCRuYW1lICYmIGlzX251bWVyaWMoJHdpZHRoKSAmJiBpc19udW1lcmljKCRoZWlnaHQpKQ0KCXsgDQoJCSRlYmxpc3RtYiA9ICgkZWJsaXN0bWIgPT0gIm9uIikgPyAxIDogMDsNCgkJDQoJCSRycyA9IEBzYWZlX2luc2VydCgnZWJsX2Nyb3AnLCAiDQoJCQlgbmFtZWAJID0gJyRuYW1lJywNCgkJCWB3aWR0aGAJID0gJyR3aWR0aCcsDQoJCQlgaGVpZ2h0YCA9ICckaGVpZ2h0JywNCgkJCWB0aHVtYmAgID0gJyRlYmxpc3RtYiciKTsNCg0KCQlyZXR1cm4gKCRycykgPw0KCQkJIk5ldyBjcm9wIHN0eWxlIGNyZWF0ZWQiIDogDQoJCQkiPGI+RXJyb3I6PC9iPiBEdXBsaWNhdGUgTmFtZSI7CQ0KCQkNCgl9IGVsc2Ugew0KCQkNCgkJcmV0dXJuICI8Yj5XaWR0aDwvYj4gYW5kIDxiPkhlaWdodDwvYj4gbXVzdCBiZSBudW1lcmljIHZhbHVlcyI7DQoJfQ0KCQ0KCXJldHVybiBGQUxTRTsNCn0NCg0KZnVuY3Rpb24gZWJsX2Nyb3BkZWxldGUoKQ0Kew0KCSRuYW1lID0gcHMoJ3N0eWxlbmFtZScpOw0KCXJldHVybiAoc2FmZV9kZWxldGUoJ2VibF9jcm9wJywgImBuYW1lYCA9ICciLmRvU2xhc2goJG5hbWUpLiInIikpID8gDQoJCSI8Yj5EZWxldGVkPC9iPiAkbmFtZSIgOiANCgkJIjxiPkVycm9yPC9iPiBVbmFibGUgdG8gZGVsZXRlICRuYW1lIjsgDQp9DQoNCg0KaWYoZ3BzKCdzdGVwJykgPT0gJ2ltYWdlX2VkaXQnIHx8IGdwcygnc3RlcCcpID09ICd0aHVtYm5haWxfaW5zZXJ0JyB8fCBncHMoJ3N0ZXAnKSA9PSAnaW1hZ2VfcmVwbGFjZScgfHwgZ3BzKCdzdGVwJykgPT0gJ3RodW1ibmFpbF9jcmVhdGUnIHx8IGdwcygnc3RlcCcpID09ICd0aHVtYm5haWxfZGVsZXRlJykgew0KCXJlZ2lzdGVyX2NhbGxiYWNrKCdlYmxfaW1nY3JvcCcsICdhZG1pbl9zaWRlJywgJ2hlYWRfZW5kJyk7DQp9DQoNCmZ1bmN0aW9uIGVibF9pbWdjcm9wKCkgew0KDQoJZ2xvYmFsICRwYXRoX3RvX3NpdGUsJGltZ19kaXI7DQoNCgkkaWQ9Z3BzKCdpZCcpOw0KCSRpbWFnZWRpciA9IGh1IC4gJGltZ19kaXIgLiAnLyc7DQoNCgkkcnMgPSBAc2FmZV9yb3coIiosIHVuaXhfdGltZXN0YW1wKGRhdGUpIGFzIHVEYXRlIiwgInR4cF9pbWFnZSIsICJpZCA9ICRpZCIpOw0KDQoJaWYgKCRycykgew0KCQlleHRyYWN0KCRycyk7DQoJCSRmaWxlbmFtZSA9ICRpZC4kZXh0Ow0KCQkkaW1nc3JjID0gJGltYWdlZGlyLiRmaWxlbmFtZTsNCgkJJHRtYnNyYyA9ICRpbWFnZWRpci4kaWQuJ3QnLiRleHQ7DQoJfQ0KCQ0KCSRjdXN0b21UaHVtYlNpemUgPSBzZWxlY3RTdHlsZXMoMSk7DQoJJGN1c3RvbUltZ1NpemUgPSBzZWxlY3RTdHlsZXMoMCk7DQoJDQoJZWNobyA8PDwgRU9GDQo8c2NyaXB0IHNyYz0iamNyb3AvanF1ZXJ5Lkpjcm9wLnBhY2suanMiPjwvc2NyaXB0Pg0KPGxpbmsgaHJlZj0iamNyb3AvanF1ZXJ5Lkpjcm9wLmNzcyIgcmVsPSJzdHlsZXNoZWV0IiB0eXBlPSJ0ZXh0L2NzcyIgLz4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQojZWJsaW1ncHJvY2VzcyB7DQoJbWFyZ2luOiA1cHg7DQoJZm9udC13ZWlnaHQ6IGJvbGQ7IA0KCWZvbnQtc2l6ZTogMTRwdDsNCgljb2xvcjogIzU1MDAwMDsNCglwYWRkaW5nOiAwIDAgMCAyMHB4Ow0KCWJhY2tncm91bmQ6IHVybCgnamNyb3AvcHJvY2Vzc2luZy5naWYnKSBsZWZ0IG5vLXJlcGVhdDsNCn0NCmEgeyBwYWRkaW5nOiAwIDAgM3B4O30NCmE6dmlzaXRlZCB7fSBhOmhvdmVyIHt9IGE6YWN0aXZlIHsgYm9yZGVyOiAwOyB9DQphOmZvY3VzIHsgb3V0bGluZTogMDsgdGV4dC1kZWNvcmF0aW9uOiBub25lO30gDQo8L3N0eWxlPg0KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7IC8vIGluaXQgZXZlcnl0aGluZw0KDQoJJCgiI2xpc3QgdGQ6Zmlyc3QgaW1nIikuYXR0cignaWQnLCdtYWluSW1nJyk7IC8vIEdpdmUgb3VyIGltYWdlIGFuIElEDQoJJCgiI2xpc3QgdGQ6Zmlyc3QiKS5hdHRyKCdpZCcsJ21haW5JbWdURCcpOyAvLyBuYW1lIHRoZSB0YWJsZSB0byBtYWtlIGl0IGVhc2llciB0byBmaW5kLg0KDQoJJCgnI2ltYWdlLXRodW1ibmFpbCB0ZDpmaXJzdCBpbWcnKS5hdHRyKCdpZCcsJ3RodW1iJyk7IC8vIEdpdmUgb3VyIHRodW1ibmFpbCBpbWFnZSBhbiBJRA0KCSQoJyNpbWFnZS10aHVtYm5haWwgdGQ6Zmlyc3QnKS5hdHRyKCdpZCcsJ3RodW1iVEQnKTsgLy8gbmFtZSB0aGUgVEQgdGhhdCBjb250YWlucyB0aGUgaW1hZ2Ugc28gd2UgY2FuIHN3YXAgaXQgb3V0Lg0KDQoJaWYoISAkKCcjdGh1bWJURCcpLmxlbmd0aCApIHsgICQoIiNsaXN0IHRkOmVxKDEpIikuYXR0cignaWQnLCd0aHVtYlREJyk7ICB9DQoNCgkkKCcjbWFpbkltZ1REJykucHJlcGVuZCgnPGRpdiBpZD0iZWJsY3JvcHVpIj48L2Rpdj4nKTsNCgkkKCcjZWJsY3JvcHVpJykuYXBwZW5kKCc8ZmllbGRzZXQgc3R5bGU9Im1pbi13aWR0aDogNTAwcHg7Ij48bGVnZW5kPkVkaXQgSW1hZ2U8L2xlZ2VuZD48ZGl2IGlkPSJlYmxjb250YWluZXIiPjwvZGl2PjwvZmllbGRzZXQ+Jyk7DQoJDQoJJCgnI2VibGNvbnRhaW5lcicpLmNzcyh7J21hcmdpbic6JzEwcHgnfSk7DQoJJCgnI2VibGNvbnRhaW5lcicpLmFwcGVuZCgNCgkJCQkJCSc8cD4nICsgDQoJCQkJCQkgJzxhIGhyZWY9IiMiIGlkPSJlYmxjcm9wbG5rIiA+Q3JvcDwvYT4gfCAnICsgDQoJCQkJCQkgJzxhIGhyZWY9IiMiIGlkPSJlYmx0bWJsbmsiID5UaHVtYm5haWw8L2E+IHwgJyArIA0KCQkJCQkJICc8YSBocmVmPSIjIiBpZD0iZWJscm90YXRlbG5rIiA+Um90YXRlPC9hPiB8ICcgKw0KCQkJCQkJICc8YSBocmVmPSIjIiBpZD0iZWJscmVzaXplbG5rIiA+UmVzaXplPC9hPiB8ICcgKyANCgkJCQkJCSAnPGEgaHJlZj0iIyIgaWQ9ImVibGJhY2t1cGxuayIgPkJhY2t1cDwvYT4nICsgDQoJCQkJCQknPC9wPicNCgkJCQkJCSk7DQoJDQoJJCgnI2VibGNvbnRhaW5lcicpLmFwcGVuZCgnPGRpdiBpZD0iZWJsY3JvcGRhdGEiPjwvZGl2PjxkaXYgaWQ9ImVibGNyb3BjdHJsIj48L2Rpdj48ZGl2IGlkPSJlYmx0bWJjdHJsIj48L2Rpdj48ZGl2IGlkPSJlYmxyb3RhdGVjdHJsIj48L2Rpdj48ZGl2IGlkPSJlYmxyZXNpemUiPjwvZGl2PjxkaXYgaWQ9ImVibGJhY2t1cGltZyI+PC9kaXY+PGRpdiBpZD0iZWJsaGlkZGVuZGF0YSI+PC9kaXY+PGRpdiBpZD0iZWJsaW1ncHJvY2VzcyI+IFByb2Nlc3NpbmcuLi48L2Rpdj4nKTsNCgkNCgkkKCcjZWJsY3JvcGN0cmwnKS5hcHBlbmQoDQoJCQkJCQkJCSAnPGlucHV0IHR5cGU9ImhpZGRlbiIgaWQ9ImVibGNyb3BIaCIgbmFtZT0iZWJsY3JvcEgiIHZhbHVlPSIiIC8+JyArDQoJCQkJCQkJCSAnPGlucHV0IHR5cGU9ImhpZGRlbiIgaWQ9ImVibGNyb3BXaCIgbmFtZT0iZWJsY3JvcFciIHZhbHVlPSIiIC8+JyArDQoJCQkJCQkJCSAnPGlucHV0IHR5cGU9ImhpZGRlbiIgaWQ9ImVibGNyb3BYaCIgbmFtZT0iZWJsY3JvcFhoIiB2YWx1ZT0iIiAvPicgKw0KCQkJCQkJCQkgJzxpbnB1dCB0eXBlPSJoaWRkZW4iIGlkPSJlYmxjcm9wWWgiIG5hbWU9ImVibGNyb3BZaCIgdmFsdWU9IiIgLz4nDQoJCQkJCQkJKTsNCgkNCgkkKCcjZWJsY3JvcGN0cmwnKS5hcHBlbmQoDQoJCQkJCQkJCSc8cD5Vc2UgcHJlZGVmaW5lZCBzaXplOiAkY3VzdG9tSW1nU2l6ZSB8IDxpbnB1dCBuYW1lPSJhc3BlY3RyYXRpbyIgdHlwZT0iY2hlY2tib3giIGlkPSJpbWdhc3BlY3RyYXRpbyIgdmFsdWU9IiIgLz4gTG9jayBBc3BlY3QgUmF0aW8gPC9wPicgKw0KCQkJCQkJCQknPGlucHV0IHR5cGU9InN1Ym1pdCIgbmFtZT0iJGlkIiBpZD0iZWJsaW1nY3JvcCIgdmFsdWU9IkNyb3AgT3JpZ2luYWwiIGNsYXNzPSJzbWFsbGVyYm94IiAvPicNCgkJCQkJCQkpOw0KCQ0KCSQoJyNlYmx0bWJjdHJsJykuYXBwZW5kKAkJCQkJICAgICAJDQoJCQkJCQkJCSc8L3A+PHA+VXNlIHByZWRlZmluZWQgc2l6ZTogJGN1c3RvbVRodW1iU2l6ZSB8ICcgKyANCgkJCQkJCQkJJzxpbnB1dCBuYW1lPSJhc3BlY3RyYXRpbyIgdHlwZT0iY2hlY2tib3giIGlkPSJ0bWJhc3BlY3RyYXRpbyIgdmFsdWU9IiIgLz4gTG9jayBBc3BlY3QgUmF0aW8gPC9wPjwvcD48cD4gVGh1bWJuYWlsIERpbWVuc2lvbnM6ICcgKyANCgkJCQkJCQkJICcoIFc6IDxpbnB1dCBuYW1lPSJlYmx0bWJXIiB0eXBlPSJ0ZXh0IiBpZD0iZWJsdG1iVyIgc2l6ZT0iNSIgbWF4bGVuZ3RoPSI0IiB2YWx1ZT0iMTAwIiAvPiApIHggJyArDQoJCQkJCQkJCSAnKCBIOiA8aW5wdXQgbmFtZT0iZWJsdG1iSCIgdHlwZT0idGV4dCIgaWQ9ImVibHRtYkgiIHNpemU9IjUiIG1heGxlbmd0aD0iNCIgdmFsdWU9IjEwMCIgLz4gKScgKyANCgkJCQkJCQkJICd8IDxpbnB1dCBuYW1lPSJjcm9wdGh1bWIiIHR5cGU9ImNoZWNrYm94IiBpZD0iY3JvcHRodW1iIiBjaGVja2VkPSJ0cnVlIi8+IFJlc2l6ZSBUaHVtYm5haWwgJyArIA0KCQkJCQkJCQknPC9wPjxwPicgKyAgDQoJCQkJCQkJCSAnPGlucHV0IHR5cGU9ImJ1dHRvbiIgbmFtZT0iJGlkIiBpZD0iZWJsdG1iY3JvcCIgdmFsdWU9IkNyZWF0ZSBUaHVtYm5haWwiIGNsYXNzPSJzbWFsbGVyYm94IiAvPicgKyANCgkJCQkJCQkJJzwvcD4nDQoJCQkJCQkJKTsNCgkNCgkkKCcjZWJscm90YXRlY3RybCcpLmFwcGVuZCgNCgkJCQkJCQkJJzxwPlJvdGF0ZSA8aW5wdXQgdHlwZT0iYnV0dG9uIiBuYW1lPSIkaWQiIGlkPSJyb3RhdGVyaWdodCIgdmFsdWU9IkNsb2Nrd2lzZSA5MCZkZWc7IiBjbGFzcz0ic21hbGxlcmJveCIgLz4gJyArDQoJCQkJCQkJCSAnPGlucHV0IHR5cGU9ImJ1dHRvbiIgbmFtZT0iJGlkIiBpZD0icm90YXRlbGVmdCIgdmFsdWU9IkNvdW50ZXJjbG9ja3dpc2UgOTAmZGVnOyAiIGNsYXNzPSJzbWFsbGVyYm94IiAvPiAnICsNCgkJCQkJCQkJICc8aW5wdXQgdHlwZT0iYnV0dG9uIiBuYW1lPSIkaWQiIGlkPSJyb3RhdGV1cCIgdmFsdWU9IjE4MCAmZGVnOyAiIGNsYXNzPSJzbWFsbGVyYm94IiAvPicgKyANCgkJCQkJCQkJJzwvcD4nDQoJCQkJCQkJKTsNCgkJCQkJCQkNCgkkKCcjZWJsYmFja3VwaW1nJykuYXBwZW5kKA0KCQkJCQkJCQknPHA+PGlucHV0IHR5cGU9ImJ1dHRvbiIgbmFtZT0iJGlkIiBpZD0iZWJsYmFja3VwIiB2YWx1ZT0iQmFja3VwIiBjbGFzcz0ic21hbGxlcmJveCIgLz4gJyArDQoJCQkJCQkJCSc8aW5wdXQgdHlwZT0iYnV0dG9uIiBuYW1lPSIkaWQiIGlkPSJlYmxyZXN0b3JlIiB2YWx1ZT0iUmVzdG9yZSIgY2xhc3M9InNtYWxsZXJib3giIC8+JyArIA0KCQkJCQkJCQknPC9wPicNCgkJCQkJCQkpOw0KCQ0KCSQoJyNlYmxyZXNpemUnKS5hcHBlbmQoDQoJCQkJCQkJCSc8cD5DdXJyZW50IEltYWdlIFNpemUgOiBXWyA8c3BhbiBpZD0ib3JpZ1ciPjwvc3Bhbj4gXSB4IEhbIDxzcGFuIGlkPSJvcmlnSCI+PC9zcGFuPiBdPC9wPicgKyANCgkJCQkJCQkJJzxwPjxsYWJlbCBmb3I9ImVibHJzelciPldpZHRoOiA8L2xhYmVsPjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJlYmxyc3pXIiBpZD0iZWJscnN6VyIgLz4geCAnICsNCgkJCQkJCQkJICc8bGFiZWwgZm9yPSJlYmxyc3pIIj5IZWlnaHQ6IDwvbGFiZWw+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9ImVibHJzekgiIGlkPSJlYmxyc3pIIiAvPiAnICsNCgkJCQkJCQkgCSAnPGlucHV0IHR5cGU9ImJ1dHRvbiIgbmFtZT0iJGlkIiBpZD0iZWJscnN6aW1nIiB2YWx1ZT0iUmVzaXplIiBjbGFzcz0ic21hbGxlcmJveCIgLz4nICsNCgkJCQkJCQkJJzwvcD4nDQoJCQkJCQkJKTsNCgkNCgkkKCcjZWJsY3JvcGRhdGEnKS5hcHBlbmQoDQoJCQkJCQkJCSc8cD5DdXJyZW50IENyb3AgQXJlYSAoVzogPHNwYW4gc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkOyIgaWQ9ImVibGNyb3BXIj4wPC9zcGFuPikgeCAoSDogPHNwYW4gc3R5bGU9ImZvbnQtd2VpZ2h0OiBib2xkOyIgaWQ9ImVibGNyb3BIIj4wPC9zcGFuPik8L3A+Jw0KCQkJCQkJCSk7DQoJDQoJJCgnI2VibGNyb3BjdHJsLCNlYmxyb3RhdGVjdHJsLCNlYmxyZXNpemUsI2VibHRtYmN0cmwsI2VibGNyb3BkYXRhLCNlYmxpbWdwcm9jZXNzLCNlYmxiYWNrdXBpbWcnKS5oaWRlKCk7DQoJDQoJDQoJLy8gc2V0IG91ciBkZWZhdWx0cw0KCXdpbmRvdy5jcm9wID0gZmFsc2U7DQoJd2luZG93LnRtYmNyb3AgPSBmYWxzZTsNCg0KCSQoJyNtYWluSW1nJykud3JhcCgnPGRpdiBpZD0iaW1nRGl2Ij48L2RpdicpOw0KCSQoJyNpbWdhc3BlY3RyYXRpbywjdG1iYXNwZWN0cmF0aW8nKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpLmF0dHIoJ2NoZWNrZWQnLCBmYWxzZSk7DQoNCgkNCmZ1bmN0aW9uIHJlbW92ZUNyb3AoKSB7DQoJLy8gUmVtb3ZlcyBqQ3JvcCBpZiBmb3VuZC4NCglpZiAoICQoJy5qY3JvcC1ob2xkZXInKS5sZW5ndGggKSB7DQoJCXZhciB4ID0gJCgnI2ltZ0RpdicpOw0KCQkNCgkJLy8gZ2VuZXJhdGUgcmFuZG9tIG51bWJlciB0byBhcHBlbmQgdG8gaW1nIHVybCB0byBhdm9pZCBjYWNoZSBpc3N1ZXMNCgkJdmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpOw0KCQkNCgkJLy8gaGlkZSBXaWR0aC9IZWlnaHQgZGF0YQ0KCQkkKCcjZWJsY3JvcGRhdGEnKS5oaWRlKCk7IA0KCQkNCgkJLy8gcmVwbGFjZSByZW1vdmVkIGNvbnRlbnQgd2l0aCBqdXN0IHRoZSBpbWFnZS4NCgkJeC5lbXB0eSgpLmFwcGVuZCgnPGltZyBzcmM9IiRpbWdzcmM/JyArIHJhbmQgKyciIGlkPSJtYWluSW1nIiAvPicpOw0KCQl3aW5kb3cubXlDcm9wID0gJyc7DQoJfQ0KCQ0KCXdpbmRvdy5jcm9wT24gPSBmYWxzZTsNCgl3aW5kb3cuY3JvcCA9IGZhbHNlOw0KCXdpbmRvdy50bWJjcm9wID0gZmFsc2U7DQp9DQoNCmZ1bmN0aW9uIGFkZENyb3AoKSB7DQoJLy8gQmluZCBqQ3JvcCB0byAjbWFpbkltZw0KCXZhciBhc3BlY3RyYXRpbyA9ICQoJyNhc3BlY3RyYXRpbycpLmF0dHIoJ2NoZWNrZWQnKSA/IDEgOiAwOyAvLyBUaGFua3MgTWFuZnJlDQoNCgkvLyBEaXNwbGF5IEggWCBXDQoJJCgnI2VibGNyb3BkYXRhJykuc2hvdygpOyANCg0KCS8vIGNoZWNrIGlmIHRoZSBqY3JvcCBob2xkZXIgaXMgYWxyZWFkeSBhY3RpdmUuIExvYWQgaWYgbm90IGFjdGl2ZS4NCglpZiAoISAkKCcuamNyb3AtaG9sZGVyJykubGVuZ3RoICkgew0KCQl3aW5kb3cubXlDcm9wID0gJC5KY3JvcCgnI21haW5JbWcnLHsgDQoJCQlvblNlbGVjdDogc2hvd0Nvb3JkcywNCgkJCW9uQ2hhbmdlOiBzaG93Q29vcmRzLA0KCQkJYXNwZWN0UmF0aW86IGFzcGVjdHJhdGlvDQoJCX0pOw0KCW15Q3JvcC5zZXRTZWxlY3QoWyAwLCAwLCAxMDAsIDE1MCBdKTsNCgl9DQoJd2luZG93LmNyb3BPbiA9IHRydWU7DQp9DQoJDQoJDQoJJCgnI2VibGNyb3BsbmsnKS5jbGljayhmdW5jdGlvbiAoKSB7DQoJCSQodGhpcykuY3NzKHsnZm9udC13ZWlnaHQnOidib2xkJ30pOw0KCQkkKCcjZWJscmVzaXplbG5rLCNlYmxyb3RhdGVsbmssI2VibHRtYmxuaywjZWJsYmFja3VwbG5rJykuY3NzKCdmb250LXdlaWdodCcsJ25vcm1hbCcpOw0KCQkkKCcjZWJscm90YXRlY3RybCwjZWJsdG1iY3RybCwjZWJscmVzaXplLCNlYmxyb3RhdGVjdHJsLCNlYmxiYWNrdXBpbWcnKS5oaWRlKCk7DQoJCSQoJyNlYmxjcm9wY3RybCcpLnRvZ2dsZSgpOw0KDQoJDQoJCWlmKHdpbmRvdy5jcm9wICYmIHdpbmRvdy5jcm9wT24pIHsgLy8gdXNlciBjbG9zZWQgbWFpbiBjcm9wIGZ1bmN0aW9uDQoJCQl3aW5kb3cuY3JvcCA9IGZhbHNlOw0KCQkJcmVtb3ZlQ3JvcCgpOyAgLy8gcmVtb3ZlIHRoZSBjcm9wIGJpbmRpbmcNCgkJfSBlbHNlIGlmICghd2luZG93LmNyb3AgJiYgd2luZG93LmNyb3BPbikgeyAvLyB1c2VyIHN3aXRjaGVkIGZyb20gdGh1bWIgY3JvcA0KCQkJd2luZG93LnRtYmNyb3AgPSBmYWxzZTsNCgkJCXdpbmRvdy5jcm9wID0gdHJ1ZTsNCgkJCSQoJyNpbWdhc3BlY3RyYXRpbywjdG1iYXNwZWN0cmF0aW8nKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpLmF0dHIoJ2NoZWNrZWQnLCBmYWxzZSk7DQoJCQkkKCcjY3VzdG9tc2l6ZTAnKS52YWwoJ0N1c3RvbScpOw0KCQkJbXlDcm9wLnNldE9wdGlvbnMoe2FzcGVjdFJhdGlvOiAwfSk7DQoJCQlteUNyb3AuYW5pbWF0ZVRvKFsgMCwgMCwgMTAwLCAxNTAgXSk7DQoJCX0gZWxzZSB7IC8vIHVzZXIgb3BlbmVkIG1haW4gY3JvcCBmdW5jdGlvbg0KCQkJYWRkQ3JvcCgpOyAvLyBhZGQgY3JvcCBiaW5kaW5nDQoJCQl3aW5kb3cuY3JvcCA9IHRydWU7DQoJCX0NCgl9KTsNCg0KCSQoJyNlYmx0bWJsbmsnKS5jbGljayhmdW5jdGlvbiAoKSB7DQoJCSQodGhpcykuY3NzKCdmb250LXdlaWdodCcsICdib2xkJyk7DQoJCSQoJyNlYmxyZXNpemVsbmssI2VibHJvdGF0ZWxuaywjZWJsY3JvcGxuaywjZWJsYmFja3VwbG5rJykuY3NzKCdmb250LXdlaWdodCcsJ25vcm1hbCcpOw0KCQkkKCcjZWJsdG1iY3RybCcpLnRvZ2dsZSgpOw0KCQkkKCcjZWJscm90YXRlY3RybCwjZWJsY3JvcGN0cmwsI2VibHJlc2l6ZSwjZWJscm90YXRlY3RybCwjZWJsYmFja3VwaW1nJykuaGlkZSgpOw0KCQ0KCQlpZih3aW5kb3cudG1iY3JvcCAmJiB3aW5kb3cuY3JvcE9uKSB7IC8vIHVzZXIgY2xvc2VkIHRodW1iIGNyb3ANCgkJCXdpbmRvdy50bWJjcm9wID0gZmFsc2U7IA0KCQkJcmVtb3ZlQ3JvcCgpOw0KCQl9IGVsc2UgaWYgKCF3aW5kb3cudG1iY3JvcCAmJiB3aW5kb3cuY3JvcE9uKSB7IC8vIHVzZXIgc3dpdGNoZWQgZnJvbSBtYWluIGNyb3ANCgkJCXdpbmRvdy50bWJjcm9wID0gdHJ1ZTsNCgkJCXdpbmRvdy5jcm9wID0gZmFsc2U7DQoJCQkkKCcjaW1nYXNwZWN0cmF0aW8sI3RtYmFzcGVjdHJhdGlvJykuYXR0cignZGlzYWJsZWQnLCB0cnVlKS5hdHRyKCdjaGVja2VkJywgZmFsc2UpOw0KCQkJJCgnI2N1c3RvbXNpemUxJykudmFsKCdDdXN0b20nKTsNCgkJCW15Q3JvcC5zZXRPcHRpb25zKHthc3BlY3RSYXRpbzogMH0pOw0KCQkJbXlDcm9wLmFuaW1hdGVUbyhbIDAsIDAsIDEwMCwgMTUwIF0pOw0KCQl9IGVsc2UgeyAvLyB1c2VyIG9wZW5zIHRodW1iIGNyb3ANCgkJCWFkZENyb3AoKTsNCgkJCXdpbmRvdy50bWJjcm9wID0gdHJ1ZTsNCgkJfQ0KCQ0KCX0pOw0KDQoJJCgnI2VibHJvdGF0ZWxuaycpLmNsaWNrKGZ1bmN0aW9uICgpIHsNCgkJJCh0aGlzKS5jc3MoJ2ZvbnQtd2VpZ2h0JywgJ2JvbGQnKTsNCgkJJCgnI2VibHJlc2l6ZWxuaywjZWJsdG1ibG5rLCNlYmxjcm9wbG5rLCNlYmxiYWNrdXBsbmsnKS5jc3MoJ2ZvbnQtd2VpZ2h0Jywnbm9ybWFsJyk7DQoJCSQoJyNlYmxjcm9wY3RybCwjZWJsdG1iY3RybCwjZWJscmVzaXplLCNlYmxjcm9wZGF0YSwjZWJsYmFja3VwaW1nJykuaGlkZSgpOw0KCQkkKCcjZWJscm90YXRlY3RybCcpLnRvZ2dsZSgpOw0KDQoJCXJlbW92ZUNyb3AoKTsNCgkJd2luZG93Lm15Q3JvcCA9ICcgJzsNCgkJd2luZG93LmNyb3AgPSBmYWxzZTsNCgl9KTsNCg0KCSQoJyNlYmxyZXNpemVsbmsnKS5jbGljayhmdW5jdGlvbiAoKSB7DQoJCSQodGhpcykuY3NzKCdmb250LXdlaWdodCcsICdib2xkJyk7DQoJCSQoJyNlYmxyb3RhdGVsbmssI2VibHRtYmxuaywjZWJsY3JvcGxuaywjZWJsYmFja3VwbG5rJykuY3NzKCdmb250LXdlaWdodCcsJ25vcm1hbCcpOw0KCQkkKCcjZWJscm90YXRlY3RybCwjZWJsY3JvcGN0cmwsI2VibHRtYmN0cmwsI2VibHJvdGF0ZWN0cmwsI2VibGNyb3BkYXRhLCNlYmxiYWNrdXBpbWcnKS5oaWRlKCk7DQoJCSQoJyNlYmxyZXNpemUnKS50b2dnbGUoKTsNCgkJDQoJCXZhciBpbWdXID0gJCgnI21haW5JbWcnKS53aWR0aCgpOw0KCQl2YXIgaW1nSCA9ICQoJyNtYWluSW1nJykuaGVpZ2h0KCk7DQoJCQ0KCQkkKCcjb3JpZ1cnKS50ZXh0KGltZ1cpOw0KCQkkKCcjb3JpZ0gnKS50ZXh0KGltZ0gpOw0KCQkNCgkJcmVtb3ZlQ3JvcCgpOwkNCgl9KTsNCg0KCSQoJyNyb3RhdGVsZWZ0JykuY2xpY2soZnVuY3Rpb24gKCkgew0KCQlyZW1vdmVDcm9wKCk7DQoJCXZhciBpZCA9ICQoJyNyb3RhdGVyaWdodCcpLmF0dHIoJ25hbWUnKTsNCg0KCQl2YXIgcmFuZCA9IE1hdGgucmFuZG9tKCk7DQoJCSQoJyNlYmxpbWdwcm9jZXNzJykuc2hvdygpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTogIlBPU1QiLA0KCQkJdXJsOiAiaW5kZXgucGhwP2V2ZW50PWVibHJvdGF0ZWxlZnQmaW1naWQ9IitpZCwNCgkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKGh0bWwpew0KCQkJCWlmKGh0bWwubWF0Y2goL3N1Y2Nlc3MvKSkgew0KCQkJCQkkKCcjZWJsaW1ncHJvY2VzcycpLmhpZGUoKTsNCgkJCQkJdmFyIHggPSAkKCcjaW1nRGl2Jyk7DQoJCQkJCXguZW1wdHkoKS5hcHBlbmQoJzxpbWcgc3JjPSIkaW1nc3JjPycgKyByYW5kICsnIiBpZD0ibWFpbkltZyIgLz4nKTsJCQkJCQ0KCQkJCX0gZWxzZSB7DQoJCQkJCWFsZXJ0KGh0bWwpOw0KCQkJCX0NCgkJCX0NCgkJfSk7DQoJfSk7DQoNCgkkKCcjcm90YXRlcmlnaHQnKS5jbGljayhmdW5jdGlvbiAoKSB7DQoJCXJlbW92ZUNyb3AoKTsNCgkJdmFyIGlkID0gJCgnI3JvdGF0ZXJpZ2h0JykuYXR0cignbmFtZScpOw0KCQl2YXIgcmFuZCA9IE1hdGgucmFuZG9tKCk7DQoJCSQoJyNlYmxpbWdwcm9jZXNzJykuc2hvdygpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTogIlBPU1QiLA0KCQkJdXJsOiAiaW5kZXgucGhwP2V2ZW50PWVibHJvdGF0ZXJpZ2h0JmltZ2lkPSIraWQsDQoJCQlzdWNjZXNzOiBmdW5jdGlvbihodG1sKXsNCgkJCQlpZihodG1sLm1hdGNoKC9zdWNjZXNzLykpIHsNCgkJCQkJJCgnI2VibGltZ3Byb2Nlc3MnKS5oaWRlKCk7DQoJCQkJCXZhciB4ID0gJCgnI2ltZ0RpdicpOw0KCQkJCQl4LmVtcHR5KCkuYXBwZW5kKCc8aW1nIHNyYz0iJGltZ3NyYz8nICsgcmFuZCArJyIgaWQ9Im1haW5JbWciIC8+Jyk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJYWxlcnQoaHRtbCk7DQoJCQkJfQ0KCQkJfQ0KCQl9KTsNCgl9KTsNCg0KCSQoJyNyb3RhdGV1cCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsNCgkJcmVtb3ZlQ3JvcCgpOw0KCQl2YXIgaWQgPSAkKCcjcm90YXRlcmlnaHQnKS5hdHRyKCduYW1lJyk7DQoJCXZhciByYW5kID0gTWF0aC5yYW5kb20oKTsNCgkJJCgnI2VibGltZ3Byb2Nlc3MnKS5zaG93KCk7DQoJCSQuYWpheCh7DQoJCQl0eXBlOiAiUE9TVCIsDQoJCQl1cmw6ICJpbmRleC5waHA/ZXZlbnQ9ZWJscm90YXRldXAmaW1naWQ9IitpZCwNCgkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKGh0bWwpew0KCQkJCWlmKGh0bWwubWF0Y2goL3N1Y2Nlc3MvKSkgew0KCQkJCQkkKCcjZWJsaW1ncHJvY2VzcycpLmhpZGUoKTsNCgkJCQkJdmFyIHggPSAkKCcjaW1nRGl2Jyk7DQoJCQkJCXguZW1wdHkoKS5hcHBlbmQoJzxpbWcgc3JjPSIkaW1nc3JjPycgKyByYW5kICsnIiBpZD0ibWFpbkltZyIgLz4nKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQlhbGVydChodG1sKTsNCgkJCQl9DQoJCQl9DQoJCX0pOw0KCX0pOw0KDQoJJCgnI2VibGltZ2Nyb3AnKS5jbGljayhmdW5jdGlvbiAoKSB7DQoJCXZhciBpZCA9ICQoJyNlYmxpbWdjcm9wJykuYXR0cignbmFtZScpOw0KCQl2YXIgSCA9ICQoJyNlYmxjcm9wSGgnKS5hdHRyKCd2YWx1ZScpOw0KCQl2YXIgVyA9ICQoJyNlYmxjcm9wV2gnKS5hdHRyKCd2YWx1ZScpOw0KCQl2YXIgWCA9ICQoJyNlYmxjcm9wWGgnKS5hdHRyKCd2YWx1ZScpOw0KCQl2YXIgWSA9ICQoJyNlYmxjcm9wWWgnKS5hdHRyKCd2YWx1ZScpOw0KCQkkKCcjZWJsaW1ncHJvY2VzcycpLnNob3coKTsNCgkJdmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTogIlBPU1QiLA0KCQkJdXJsOiAiaW5kZXgucGhwP2V2ZW50PWVibGltZ2Nyb3AmaW1naWQ9IitpZCwNCgkJCWRhdGE6IAkiJmVibGNyb3BYaD0iICsgWCArICImZWJsY3JvcFloPSIgKyBZICsgIiZlYmxjcm9wVz0iICsgVyArICImZWJsY3JvcEg9IiArIEgsDQoJCQlzdWNjZXNzOiBmdW5jdGlvbihodG1sKXsNCgkJCQkkKCcjZWJsaW1ncHJvY2VzcycpLmhpZGUoKTsNCgkJCQlpZihodG1sLm1hdGNoKC9zdWNjZXNzLykpIHsNCgkJCQkJcmVtb3ZlQ3JvcCgpOw0KCQkJCQkkKCcjZWJsY3JvcGN0cmwnKS50b2dnbGUoKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQlhbGVydChodG1sKTsNCgkJCQl9DQoJCQl9DQoJCX0pOw0KCX0pOw0KCQ0KCSQoJyNlYmx0bWJjcm9wJykuY2xpY2soZnVuY3Rpb24gKCkgew0KCQl2YXIgaWQgPSAkKCcjZWJsaW1nY3JvcCcpLmF0dHIoJ25hbWUnKTsNCgkJdmFyIEggPSAkKCcjZWJsY3JvcEhoJykuYXR0cigndmFsdWUnKTsNCgkJdmFyIFcgPSAkKCcjZWJsY3JvcFdoJykuYXR0cigndmFsdWUnKTsNCgkJdmFyIFggPSAkKCcjZWJsY3JvcFhoJykuYXR0cigndmFsdWUnKTsNCgkJdmFyIFkgPSAkKCcjZWJsY3JvcFloJykuYXR0cigndmFsdWUnKTsNCgkJDQoJCXZhciB0SCA9ICQoJyNlYmx0bWJIJykuYXR0cigndmFsdWUnKTsNCgkJdmFyIHRXID0gJCgnI2VibHRtYlcnKS5hdHRyKCd2YWx1ZScpOw0KDQoJCSQoJyNlYmxpbWdwcm9jZXNzJykuc2hvdygpOw0KCQl2YXIgcnN6VG1iID0gJCgnI2Nyb3B0aHVtYicpLmF0dHIoJ2NoZWNrZWQnKSA/ICdyc3onIDogJ25vJzsNCgkJCQ0KCQl2YXIgcmFuZCA9IE1hdGgucmFuZG9tKCk7DQoJCSQuYWpheCh7DQoJCQl0eXBlOiAiUE9TVCIsDQoJCQl1cmw6ICJpbmRleC5waHA/ZXZlbnQ9ZWJsdG1iY3JvcCZpbWdpZD0iK2lkLA0KCQkJZGF0YTogIiZyc3pUbWI9IiArIHJzelRtYiArICImZWJsY3JvcFhoPSIgKyBYICsgIiZlYmxjcm9wWWg9IiArIFkgKyAiJmVibGNyb3BXPSIgKyBXICsgIiZlYmxjcm9wSD0iICsgSCArICImZWJsdG1iSD0iICsgdEggKyAiJmVibHRtYlc9IiArIHRXLA0KCQkJc3VjY2VzczogZnVuY3Rpb24oaHRtbCl7DQoJCQkJJCgnI2VibGltZ3Byb2Nlc3MnKS5oaWRlKCk7DQoJCQkJaWYoaHRtbC5tYXRjaCgvc3VjY2Vzcy8pKSB7DQoJCQkJCXJlbW92ZUNyb3AoKTsNCgkJCQkJJCgnI3RodW1iVEQnKS5lbXB0eSgpLmFwcGVuZCgnPGltZyBzcmM9IiR0bWJzcmM/JyArIHJhbmQgKyciIGlkPSJ0aHVtYiIgLz4nKTsNCgkJCQkJJCgnI2VibHRtYmN0cmwnKS50b2dnbGUoKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQlhbGVydChodG1sKTsNCgkJCQl9DQoJCQl9DQoJCX0pOw0KCX0pOw0KCQ0KCSQoJyNlYmxyc3ppbWcnKS5jbGljayhmdW5jdGlvbiAoKSB7DQoJCXZhciBpZCA9ICQoJyNlYmxyc3ppbWcnKS5hdHRyKCduYW1lJyk7DQoJCXZhciBIID0gJCgnI2VibHJzekgnKS5hdHRyKCd2YWx1ZScpOw0KCQl2YXIgVyA9ICQoJyNlYmxyc3pXJykuYXR0cigndmFsdWUnKTsNCgkNCgkJJCgnI2VibGltZ3Byb2Nlc3MnKS5zaG93KCk7DQoJCQkNCgkJdmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTogIlBPU1QiLA0KCQkJdXJsOiAiaW5kZXgucGhwP2V2ZW50PWVibHJzemltZyZpbWdpZD0iK2lkLA0KCQkJZGF0YTogIiZlYmxyc3pIPSIgKyBIICsgIiZlYmxyc3pXPSIgKyBXLA0KCQkJc3VjY2VzczogZnVuY3Rpb24oaHRtbCl7DQoJCQkJJCgnI2VibGltZ3Byb2Nlc3MnKS5oaWRlKCk7DQoJCQkJaWYoaHRtbC5tYXRjaCgvc3VjY2Vzcy8pKSB7DQoJCQkJCXZhciB4ID0gJCgnI2ltZ0RpdicpOw0KCQkJCQl4LmVtcHR5KCkuYXBwZW5kKCc8aW1nIHNyYz0iJGltZ3NyYz8nICsgcmFuZCArJyIgaWQ9Im1haW5JbWciIC8+Jyk7DQoJCQkJCS8vIA0KCQkJCX0gZWxzZSB7DQoJCQkJCWFsZXJ0KGh0bWwpOw0KCQkJCX0NCgkJCX0NCgkJfSk7DQoJfSk7DQoNCg0KCSQoJyNlYmxiYWNrdXBsbmsnKS5jbGljayhmdW5jdGlvbiAoKSB7DQoJCSQodGhpcykuY3NzKCdmb250LXdlaWdodCcsICdib2xkJyk7DQoJCSQoJyNlYmxyb3RhdGVsbmssICNlYmxyZXNpemVsbmssI2VibHRtYmxuaywjZWJsY3JvcGxuaycpLmNzcygnZm9udC13ZWlnaHQnLCdub3JtYWwnKTsNCgkJJCgnI2VibHJvdGF0ZWN0cmwsI2VibGNyb3BjdHJsLCNlYmx0bWJjdHJsLCNlYmxyZXNpemUsI2VibHJvdGF0ZWN0cmwsI2VibGNyb3BkYXRhJykuaGlkZSgpOw0KCQkkKCcjZWJsYmFja3VwaW1nJykudG9nZ2xlKCk7DQoJfSk7DQoJDQoJJCgnI2VibGJhY2t1cCcpLmNsaWNrKGZ1bmN0aW9uICgpIHsNCgkJdmFyIGlkID0gJCh0aGlzKS5hdHRyKCduYW1lJyk7DQoJCSQoJyNlYmxpbWdwcm9jZXNzJykuc2hvdygpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTogIlBPU1QiLA0KCQkJdXJsOiAiaW5kZXgucGhwP2V2ZW50PWVibGJhY2t1cGltZyZpbWdpZD0iK2lkLA0KCQkJc3VjY2VzczogZnVuY3Rpb24oaHRtbCl7DQoJCQkJaWYoaHRtbC5tYXRjaCgvc3VjY2Vzcy8pKSB7DQoJCQkJCSQoJyNlYmxpbWdwcm9jZXNzJykuaGlkZSgpOw0KCQkJCQlhbGVydCgiaW1hZ2UgYmFja2VkIHVwIik7DQoJCQkJfSBlbHNlIHsNCgkJCQkJJCgnI2VibGltZ3Byb2Nlc3MnKS5oaWRlKCk7DQoJCQkJCWFsZXJ0KCJFcnJvciA6ICIgKyBpZCArICIgIHwgICAiICsgaHRtbCk7DQoJCQkJfQ0KCQkJfQ0KCQl9KTsNCgl9KTsNCgkNCgkkKCcjZWJscmVzdG9yZScpLmNsaWNrKGZ1bmN0aW9uICgpIHsNCgkJdmFyIGlkID0gJCh0aGlzKS5hdHRyKCduYW1lJyk7DQoJCSQoJyNlYmxpbWdwcm9jZXNzJykuc2hvdygpOw0KCQl2YXIgcmFuZCA9IE1hdGgucmFuZG9tKCk7DQoJCSQuYWpheCh7DQoJCQl0eXBlOiAiUE9TVCIsDQoJCQl1cmw6ICJpbmRleC5waHA/ZXZlbnQ9ZWJscmVzdG9yZWltZyZpbWdpZD0iK2lkLA0KCQkJc3VjY2VzczogZnVuY3Rpb24oaHRtbCl7DQoJCQkJaWYoaHRtbC5tYXRjaCgvc3VjY2Vzcy8pKSB7DQoJCQkJCSQoJyNlYmxpbWdwcm9jZXNzJykuaGlkZSgpOw0KCQkJCQlhbGVydCgiaW1hZ2UgcmVzdG9yZWQiKTsNCgkJCQkJdmFyIHggPSAkKCcjaW1nRGl2Jyk7DQoJCQkJCXguZW1wdHkoKS5hcHBlbmQoJzxpbWcgc3JjPSIkaW1nc3JjPycgKyByYW5kICsnIiBpZD0ibWFpbkltZyIgLz4nKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQkkKCcjZWJsaW1ncHJvY2VzcycpLmhpZGUoKTsNCgkJCQkJYWxlcnQoIkVycm9yIDogIiArIGh0bWwpOw0KCQkJCX0NCgkJCX0NCgkJfSk7DQoJfSk7DQoJDQoJJCgnI2N1c3RvbXNpemUwLCNjdXN0b21zaXplMScpLmNoYW5nZShmdW5jdGlvbiAoKSB7DQoJCXZhciBzaXplID0gJCh0aGlzKS52YWwoKTsNCgkJaWYoIXNpemUubWF0Y2goIkN1c3RvbSIpKSB7DQoJCQkkKCcjaW1nYXNwZWN0cmF0aW8sI3RtYmFzcGVjdHJhdGlvJykuYXR0cignZGlzYWJsZWQnLCBmYWxzZSkuYXR0cignY2hlY2tlZCcsIHRydWUpOw0KCQkJdmFyIHggPSBzaXplLnNwbGl0KCd4JylbMF07DQoJCQl2YXIgeSA9IHNpemUuc3BsaXQoJ3gnKVsxXTsNCg0KCQkJbXlDcm9wLmFuaW1hdGVUbyhbIDAsIDAsIHgsIHkgXSk7DQoJCQkNCgkJCXZhciBhc3BlY3RyYXRpbyA9IHggLyB5Ow0KDQoJCQl2YXIgb3B0ID0gew0KCQkJCWFzcGVjdFJhdGlvOiBhc3BlY3RyYXRpbw0KCQkJfQ0KCQkJDQoJCQlteUNyb3Auc2V0T3B0aW9ucyhvcHQpOw0KCQl9IGVsc2Ugew0KCQkJJCgnI2ltZ2FzcGVjdHJhdGlvLCN0bWJhc3BlY3RyYXRpbycpLmF0dHIoJ2Rpc2FibGVkJywgdHJ1ZSkuYXR0cignY2hlY2tlZCcsIGZhbHNlKTsNCgkJCW15Q3JvcC5zZXRPcHRpb25zKHthc3BlY3RSYXRpbzogMH0pOw0KCQl9DQoJCQ0KCX0pOw0KDQoJJCgnI2ltZ2FzcGVjdHJhdGlvLCN0bWJhc3BlY3RyYXRpbycpLmNoYW5nZShmdW5jdGlvbiAoKSB7DQoJCWlmKCQodGhpcykuYXR0cignY2hlY2tlZCcpKQ0KCQl7DQoJCQlpZih0aGlzLmlkID09PSAnaW1nYXNwZWN0cmF0aW8nKSANCgkJCXsNCgkJCQl2YXIgc2l6ZSA9ICQoJyNjdXN0b21zaXplMCcpLnZhbCgpOw0KCQkJfSBlbHNlIHsNCgkJCQl2YXIgc2l6ZSA9ICQoJyNjdXN0b21zaXplMScpLnZhbCgpOw0KCQkJfQ0KCQkJDQoJCQl2YXIgeCA9IHNpemUuc3BsaXQoJ3gnKVswXTsNCgkJCXZhciB5ID0gc2l6ZS5zcGxpdCgneCcpWzFdOwkNCgkJCQ0KCQkJdmFyIGFzcGVjdHJhdGlvID0geCAvIHk7DQoJCQlteUNyb3AuYW5pbWF0ZVRvKFsgMCwgMCwgeCwgeSBdKTsNCg0KCQl9IGVsc2Ugew0KCQkJdmFyIGFzcGVjdHJhdGlvID0gMDsNCgkJCQ0KCQl9DQoNCgkJdmFyIG9wdCA9IHsNCgkJCWFzcGVjdFJhdGlvOiBhc3BlY3RyYXRpbw0KCQl9DQoJCW15Q3JvcC5zZXRPcHRpb25zKG9wdCk7DQoJfSk7DQoJDQoJJCgnI2Nyb3B0aHVtYicpLmNoYW5nZShmdW5jdGlvbiAoKSB7DQoJCQl2YXIgY3JvcHRodW1iID0gJCh0aGlzKS5hdHRyKCdjaGVja2VkJykgPyBmYWxzZSA6IHRydWU7DQoJCQkNCgkJCWlmKGNyb3B0aHVtYikgew0KCQkJCSQoJyNlYmx0bWJXLCAjZWJsdG1iSCcpLmF0dHIoe2Rpc2FibGVkOiJkaXNhYmxlZCIsdmFsdWU6IiMjIyJ9KTsNCgkJCX0gZWxzZSB7DQoJCQkJJCgnI2VibHRtYlcsICNlYmx0bWJIJykucmVtb3ZlQXR0cigiZGlzYWJsZWQiKTsNCgkJCQkkKCcjZWJsdG1iVywgI2VibHRtYkgnKS5hdHRyKCJ2YWx1ZSIsIjEwMCIpOw0KCQkJfQ0KCX0pOw0KfSk7DQoNCmZ1bmN0aW9uIHNob3dDb29yZHMoYykgew0KCQkkKCcjZWJsY3JvcFgnKS50ZXh0KGMueCk7DQoJCSQoJyNlYmxjcm9wWGgnKS52YWwoYy54KTsNCgkJJCgnI2VibGNyb3BZJykudGV4dChjLnkpOw0KCQkkKCcjZWJsY3JvcFloJykudmFsKGMueSk7DQoJCSQoJyNlYmxjcm9wWDInKS50ZXh0KGMueDIpOw0KCQkkKCcjZWJsY3JvcFgyaCcpLnZhbChjLngyKTsNCgkJJCgnI2VibGNyb3BZMicpLnRleHQoYy55Mik7DQoJCSQoJyNlYmxjcm9wWTJoJykudmFsKGMueTIpOw0KCQkNCgkJdmFyIGltZ1cgPSB6ZXJvUGFkKGMudyw0KTsNCgkJdmFyIGltZ0ggPSB6ZXJvUGFkKGMuaCw0KTsNCgkJDQoJCSQoJyNlYmxjcm9wVycpLnRleHQoaW1nVyk7DQoJCSQoJyNlYmxjcm9wV2gnKS52YWwoYy53KTsNCgkJJCgnI2VibGNyb3BIJykudGV4dChpbWdIKTsNCgkJJCgnI2VibGNyb3BIaCcpLnZhbChjLmgpOw0KfTsNCg0KZnVuY3Rpb24gemVyb1BhZChudW0sY291bnQpIHsNCgl2YXIgbnVtWmVyb3BhZCA9IG51bSArICcnOw0KCXdoaWxlKG51bVplcm9wYWQubGVuZ3RoIDwgY291bnQpIHsNCgkJbnVtWmVyb3BhZCA9ICIwIiArIG51bVplcm9wYWQ7DQoJfQ0KCXJldHVybiBudW1aZXJvcGFkOw0KfQ0KDQo8L3NjcmlwdD4NCkVPRjsNCg0KfQ0KDQpmdW5jdGlvbiBlYmxyZXN0b3JlaW1nKCRpZCkgDQp7DQoJDQoJZ2xvYmFsICRwYXRoX3RvX3NpdGUsJGltZ19kaXI7DQoJDQoJJHJzID0gc2FmZV9yb3coIiosIHVuaXhfdGltZXN0YW1wKGRhdGUpIGFzIHVEYXRlIiwgInR4cF9pbWFnZSIsICJpZCA9ICRpZCIpOw0KCQkNCglpZiAoJHJzKSB7DQoJCSRiYWNrdXBkaXIgCT0gJHBhdGhfdG9fc2l0ZSAuICcvJyAuICRpbWdfZGlyIC4gJy9iYWNrdXAvJzsNCgkJJGltYWdlZGlyCT0gJHBhdGhfdG9fc2l0ZSAuICcvJyAuICRpbWdfZGlyIC4gJy8nOw0KCQkNCgkJZXh0cmFjdCgkcnMpOw0KCQkkZmlsZW5hbWUgPSAkaWQuJGV4dDsNCgkJJGltZ3NyYyA9ICRpbWFnZWRpci4kZmlsZW5hbWU7CQkNCgkJDQoJCWlmKGNvcHkoJGJhY2t1cGRpci4kZmlsZW5hbWUsICRpbWFnZWRpci4kZmlsZW5hbWUpKSANCgkJew0KCQkJbGlzdCgkd2lkdGgsICRoZWlnaHQpID0gZ2V0aW1hZ2VzaXplKCRiYWNrdXBkaXIuJGZpbGVuYW1lKTsNCgkJCWlmKHNhZmVfdXBkYXRlKCd0eHBfaW1hZ2UnLCAidyA9ICciLiR3aWR0aC4iJywgaCA9ICciLiRoZWlnaHQuIiciLCAiaWQgPSAkaWQiKSkgDQoJCQl7DQoJCQkJZWNobyAic3VjY2VzcyI7IGV4aXQoKTsNCgkJCX0gZWxzZSB7DQoJCQkJZWNobyAiRmlsZSBDb3BpZWQgYnV0IGRiIG5vdCB1cGRhdGVkIjsNCgkJCX0NCgkJfQ0KCX0gZWxzZSB7DQoJCWVjaG8gIkRhdGFiYXNlIEVycm9yIjsNCgl9DQoNCglleGl0KCk7DQp9DQoNCmZ1bmN0aW9uIGVibGJhY2t1cGltZygkaWQpIA0KewkNCglnbG9iYWwgJHBhdGhfdG9fc2l0ZSwkaW1nX2RpcjsNCgkNCgkkcnMgPSBzYWZlX3JvdygiKiwgdW5peF90aW1lc3RhbXAoZGF0ZSkgYXMgdURhdGUiLCAidHhwX2ltYWdlIiwgImlkID0gJGlkIik7DQoNCglpZiAoJHJzKSB7DQoJCSRiYWNrdXBkaXIgCT0gJHBhdGhfdG9fc2l0ZSAuICcvJyAuICRpbWdfZGlyIC4gJy9iYWNrdXAvJzsNCgkJJGltYWdlZGlyCT0gJHBhdGhfdG9fc2l0ZSAuICcvJyAuICRpbWdfZGlyIC4gJy8nOw0KCQkNCgkJZXh0cmFjdCgkcnMpOw0KCQkkZmlsZW5hbWUgPSAkaWQuJGV4dDsNCgkJJGltZ3NyYyA9ICRpbWFnZWRpci4kZmlsZW5hbWU7IGVjaG8gJGltYWdlZGlyLiRmaWxlbmFtZTsNCgkNCgkJJGNyID0gY29weSgkaW1hZ2VkaXIuJGZpbGVuYW1lLCRiYWNrdXBkaXIuJGZpbGVuYW1lKTsNCgkJZWNobyAic3VjY2VzcyI7DQoJfSBlbHNlIHsNCgkJZWNobyAiRGF0YWJhc2UgRXJyb3IiOw0KCX0NCgkNCglleGl0KCk7DQp9DQoNCmZ1bmN0aW9uIGVibF9pbWdfZWRpdCAoJGlkLCAkZGlyZWN0aW9uLCAkYWN0aW9uKQ0Kew0KCWdsb2JhbCAkcGF0aF90b19zaXRlLCRpbWdfZGlyOw0KDQoJJGltYWdlZGlyID0gJHBhdGhfdG9fc2l0ZSAuICcvJyAuICRpbWdfZGlyIC4gJy8nOw0KDQoJJHJzID0gc2FmZV9yb3coIiosIHVuaXhfdGltZXN0YW1wKGRhdGUpIGFzIHVEYXRlIiwgInR4cF9pbWFnZSIsICJpZCA9ICRpZCIpOw0KDQoJaWYgKCRycykgew0KCQlleHRyYWN0KCRycyk7DQoJCSRmaWxlbmFtZSA9ICRpZC4kZXh0Ow0KDQoJCXN3aXRjaCAoc3RydG9sb3dlcigkZXh0KSkgew0KCQkJY2FzZSAnLmpwZyc6DQoJCQkJJHNyY2ltYWdlID0gaW1hZ2VjcmVhdGVmcm9tanBlZygkaW1hZ2VkaXIgLiAkZmlsZW5hbWUpOw0KCQkJCWJyZWFrOw0KCQkJY2FzZSAnLmdpZic6DQoJCQkJJHNyY2ltYWdlID0gaW1hZ2VjcmVhdGVmcm9tZ2lmKCRpbWFnZWRpciAuICRmaWxlbmFtZSk7DQoJCQkJYnJlYWs7DQoJCQljYXNlICcucG5nJzoNCgkJCQkkc3JjaW1hZ2UgPSBpbWFnZWNyZWF0ZWZyb21wbmcoJGltYWdlZGlyIC4gJGZpbGVuYW1lKTsNCgkJCQlicmVhazsNCgkJfQ0KDQoJCWlmKCRhY3Rpb24gPT0gJ3JvdGF0ZScpIHsgLy8gcm90YXRlIGltYWdlDQoNCgkJCS8qKiBUZXJuYXJ5IGVxdWl2YWxlbnQgb2YgIGlmIC8gZWxzZWlmIC8gZWxzZSA6IERvbmUgZm9yIHNpbXBsZSBzaG9ydGhhbmQuIEFzc3VtZXMgYW55dGhpbmcgbm90IHJpZ2h0IC8gbGVmdCA9IDE4MCAqKi8NCgkJCSRkZWdyZWVzID0gKCRkaXJlY3Rpb24gPT0gJ3JpZ2h0JykgPyAtOTAgOiAoKCRkaXJlY3Rpb24gPT0gJ2xlZnQnKSA/IDkwIDogMTgwKTsNCgkJCSRuZXdpbWcgID0gaW1hZ2Vyb3RhdGUoJHNyY2ltYWdlLCAkZGVncmVlcywgMCk7DQoJCX0gZWxzZWlmICgkYWN0aW9uID09ICdjcm9wJykgeyAvLyBwcmltYXJ5IGltYWdlIGNyb3BwaW5nDQoNCgkJCS8vZ2F0aGVyIGNyb3AgdmFyaWFibGVzIGZyb20gaGlkZGVuIGZpZWxkcy4NCgkJCSRjcm9wWCA9IGdwcygnZWJsY3JvcFhoJyk7DQoJCQkkY3JvcFkgPSBncHMoJ2VibGNyb3BZaCcpOw0KCQkJJHRhcmdXID0gJGNyb3BXID0gZ3BzKCdlYmxjcm9wVycpOw0KCQkJJHRhcmdIID0gJGNyb3BIID0gZ3BzKCdlYmxjcm9wSCcpOw0KCQkJDQoJCQkvLyBwcmV2ZW50cyBkaXZpc2lvbiBieSB6ZXJvICYgaW52YWxpZCBjcm9wIHdpZHRocy4NCgkJCSR2YWx1ZSA9IChpbnQpJHRhcmdIICsgKGludCkkdGFyZ1c7DQoJCQlpZigkdmFsdWUgPCAzMCkgew0KCQkJCWVjaG8gImludmFsaWQgY3JvcCB2YWx1ZXMgZGV0ZWN0ZWQiOw0KCQkJCWltYWdlZGVzdHJveSgkc3JjaW1hZ2UpOw0KCQkJCWV4aXQoKTsNCgkJCX0NCg0KCQkJLyoqIENyZWF0ZSBiYXNlIGNhbnZhcyAqKi8NCgkJCSRuZXdpbWcgPSBpbWFnZWNyZWF0ZXRydWVjb2xvcigkdGFyZ1csJHRhcmdIKTsNCg0KCQkJLyoqIFVzZSB0aGUgWC9ZIGNvb3JkcyB0byBwbG90IHRoZSBpbml0aWFsIHBvaW50LCB3aWR0aC9oZWlnaHQgdGFrZSBjYXJlIG9mIHRoZSByZXN0ICoqLw0KCQkJaW1hZ2Vjb3B5cmVzYW1wbGVkKCRuZXdpbWcsICRzcmNpbWFnZSwwLDAsICRjcm9wWCwgJGNyb3BZLCAkdGFyZ1csICR0YXJnSCwgJGNyb3BXLCAkY3JvcEgpOw0KDQoJCX0gZWxzZWlmICgkYWN0aW9uID09ICd0aHVtYm5haWwnKSB7IC8vIGNyZWF0ZSB0aHVtYm5haWwNCg0KCQkJLy9nYXRoZXIgY3JvcCB2YXJpYWJsZXMgZnJvbSBoaWRkZW4gZmllbGRzLg0KCQkJJGNyb3BYID0gZ3BzKCdlYmxjcm9wWGgnKTsNCgkJCSRjcm9wWSA9IGdwcygnZWJsY3JvcFloJyk7DQoJCQkkY3JvcEggPSBncHMoJ2VibGNyb3BIJyk7DQoJCQkkY3JvcFcgPSBncHMoJ2VibGNyb3BXJyk7DQoJCQkNCgkJCS8vIHByZXZlbnRzIGRpdmlzaW9uIGJ5IHplcm8gJiBpbnZhbGlkIGNyb3Agd2lkdGhzLg0KCQkJJHZhbHVlID0gKGludCkkY3JvcEggKyAoaW50KSRjcm9wVzsNCgkJCWlmKCR2YWx1ZSA8IDQpIHsNCgkJCQllY2hvICJpbnZhbGlkIGNyb3AgdmFsdWVzIGRldGVjdGVkIjsNCgkJCQlpbWFnZWRlc3Ryb3koJHNyY2ltYWdlKTsNCgkJCQlleGl0KCk7DQoJCQl9DQoJCQkNCgkJCWlmKGdwcygncnN6VG1iJykgPT0gInJzeiIpIHsgLy8gYXJlIHdlIHJlc2l6aW5nIHRoZSB0aGUgdGh1bWJuYWlsPw0KCQkJCSR0YXJnSCA9IGdwcygnZWJsdG1iSCcpOw0KCQkJCSR0YXJnVyA9IGdwcygnZWJsdG1iVycpOyANCgkJCQ0KCQkJLy8gZGlkIHNvbWVvbmUgZm9yZ2V0IHRvIGlucHV0IGEgaGVpZ2h0IG9yIHdpZHRoPyBJZiBzbywgZGVmYXVsdCB0byBjcm9wIHdpZHRoDQoJCQlpZigkdGFyZ0ggPCAxKSB7ICR0YXJnSCA9ICRjcm9wSDsgfQ0KCQkJaWYoJHRhcmdXIDwgMSkgeyAkdGFyZ1cgPSAkY3JvcFc7IH0NCg0KCQkJCS8vIGRldGVybWluZSB0aGUgY29ycmVjdCBzY2FsZSB2YWx1ZQ0KCQkJCSRzY2FsZSA9IG1pbigkdGFyZ1cgLyAkY3JvcFcsJHRhcmdIIC8gJGNyb3BIKTsNCgkJCQkvLyBhcmUgdGhlIHNpZGVzIGVxdWFsPyBJZiBub3QsIHNjYWxlIHRvIGZpdC4NCgkJCQlpZiAoJHNjYWxlIDwgMSkgew0KCQkJCQkkdGFyZ1cgPSBjZWlsKCRzY2FsZSAqICRjcm9wVyk7DQoJCQkJCSR0YXJnSCA9IGNlaWwoJHNjYWxlICogJGNyb3BIKTsNCgkJCQl9IA0KCQkJfSBlbHNlaWYgKGdwcygncnN6VG1iJykgIT0gJ3JzeicpIHsgLy8gaWYgbm90LCB3ZSdsbCBqdXN0IHVzZSB0aGUgY3JvcC1hcmVhIHNpemUgdG8gY3JlYXRlIG91ciB0aHVtYm5haWwNCgkJCQkkdGFyZ0ggPSAkY3JvcEg7DQoJCQkJJHRhcmdXID0gJGNyb3BXOw0KCQkJfQ0KCQkJDQoJCQkvKiogQ3JlYXRlIGJhc2UgY2FudmFzICoqLw0KCQkJJG5ld2ltZyA9IGltYWdlY3JlYXRldHJ1ZWNvbG9yKCR0YXJnVywkdGFyZ0gpOw0KCQkJLyoqIFVzZSB0aGUgWC9ZIGNvb3JkcyB0byBwbG90IHRoZSBpbml0aWFsIHBvaW50LCB3aWR0aC9oZWlnaHQgdGFrZSBjYXJlIG9mIHRoZSByZXN0ICoqLw0KCQkJaW1hZ2Vjb3B5cmVzYW1wbGVkKCRuZXdpbWcsICRzcmNpbWFnZSwwLDAsICRjcm9wWCwgJGNyb3BZLCAkdGFyZ1csICR0YXJnSCwgJGNyb3BXLCAkY3JvcEgpOw0KDQoJCX0gZWxzZWlmICgkYWN0aW9uID09ICdyc3onKSB7IC8vIGdlbmVyYWwgcmVzaXplDQoJCQkkdGFyZ0ggPSBncHMoJ2VibHJzekgnKTsNCgkJCSR0YXJnVyA9IGdwcygnZWJscnN6VycpOw0KCQkJDQoJCQlpZigoJHRhcmdIICsgJHRhcmdXKSA8IDEpIHsNCgkJCQllY2hvICIgRVJST1IgOiBEaW1lbnNpb25zIG11c3QgYmUgZW50ZXJlZC4iOw0KCQkJCXJldHVybiBmYWxzZTsNCgkJCX0NCgkJCS8vIGRpZCBzb21lb25lIGZvcmdldCB0byBpbnB1dCBhIGhlaWdodCBvciB3aWR0aD8gSWYgc28sIHdlJ2xsIGRlZmF1bHQgdG8gdGhlIG9yaWdpbmFsIHNpemUgZm9yIHRoZSBtaXNzaW5nIHZhbHVlLg0KCQkJaWYoJHRhcmdIIDwgMSkgeyAkdGFyZ0ggPSAkaDsgfQ0KCQkJaWYoJHRhcmdXIDwgMSkgeyAkdGFyZ1cgPSAkdzsgfQ0KCQkJLy8gY2hlY2tzIHRvIHNlZSBpZiB0aGUgdGFyZ2V0ZWQgdmFsdWVzIGFyZSBsYXJnZXIgdGhhbiB0aGUgb3JpZ2luYWwsIGlmIHNvLCByZXNldCB0byBvcmlnaW5hbCB2YWx1ZSBhcyB0aGUgbG9uZ2VzdCBzaWRlLg0KCQkJaWYoJHRhcmdIID4gJGgpIHsgJHRhcmdIID0gJGg7IH0NCgkJCWlmKCR0YXJnVyA+ICR3KSB7ICR0YXJnVyA9ICR3OyB9DQoJCQkNCgkJCSRzY2FsZSA9IG1pbigkdGFyZ1cgLyAkdywgJHRhcmdIIC8gJGgpOw0KCQkJLy8gYXJlIHRoZSBzaWRlcyBlcXVhbD8gSWYgbm90LCBzY2FsZSB0byBmaXQuDQoJCQlpZiAoJHNjYWxlIDwgMSkgew0KCQkJCSR0YXJnVyA9IGNlaWwoJHNjYWxlICogJHcpOw0KCQkJCSR0YXJnSCA9IGNlaWwoJHNjYWxlICogJGgpOw0KCQkJfSBlbHNlIHsgLy8gaW1hZ2UgaXMgc21hbGxlciB0aGFuIHJlcXVlc3RlZCBzY2FsZS4gQWJvcnQuDQoJCQkJaW1hZ2VkZXN0cm95KCRzcmNpbWFnZSk7DQoJCQkJZWNobyAiSW1hZ2Ugc21hbGxlciB0aGFuIHBhcmFtZXRlcnMgZW50ZXJlZCI7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KDQoJCQkvKiogQ3JlYXRlIGJhc2UgY2FudmFzICoqLw0KCQkJJG5ld2ltZyA9IGltYWdlY3JlYXRldHJ1ZWNvbG9yKCR0YXJnVywkdGFyZ0gpOw0KCQkJLyoqIFVzZSB0aGUgWC9ZIGNvb3JkcyB0byBwbG90IHRoZSBpbml0aWFsIHBvaW50LCB3aWR0aC9oZWlnaHQgdGFrZSBjYXJlIG9mIHRoZSByZXN0ICoqLw0KCQkJaW1hZ2Vjb3B5cmVzYW1wbGVkKCRuZXdpbWcsICRzcmNpbWFnZSwwLDAsMCwwLCAkdGFyZ1csICR0YXJnSCwgJHcsICRoKTsNCgkJfQ0KDQoJCSR0ID0gKCRhY3Rpb24gPT0gJ3RodW1ibmFpbCcpID8gJ3QnIDogJyc7DQoJCQ0KCQkkZmlsZW5hbWUgPSAkaWQuJHQuJGV4dDsNCgkJDQoJCXN3aXRjaCAoc3RydG9sb3dlcigkZXh0KSkgew0KCQkJY2FzZSAoJGV4dCA9PSAnLmpwZycgfHwgJGV4dCA9PSAnLmpwZWcnKToNCgkJCQkkZmlsZXJlc3VsdCA9IGltYWdlanBlZygkbmV3aW1nLCRpbWFnZWRpciAuICRmaWxlbmFtZSwnMTAwJyk7DQoJCQkJYnJlYWs7DQoJCQljYXNlICIuZ2lmIjoNCgkJCQkkZmlsZXJlc3VsdCA9IGltYWdlZ2lmKCRuZXdpbWcsJGltYWdlZGlyIC4gJGZpbGVuYW1lKTsNCgkJCQlicmVhazsNCgkJCWNhc2UgIi5wbmciOg0KCQkJCSRmaWxlcmVzdWx0ID0gaW1hZ2VwbmcoJG5ld2ltZywkaW1hZ2VkaXIgLiAkZmlsZW5hbWUpOw0KCQkJCWJyZWFrOw0KCQl9DQoNCgkJaW1hZ2VkZXN0cm95KCRzcmNpbWFnZSk7DQoJfQ0KDQoJaWYoJGFjdGlvbiAhPSAndGh1bWJuYWlsJykgDQoJew0KCQlsaXN0ICgkd2lkdGgsJGhlaWdodCkgPSBnZXRpbWFnZXNpemUoJGltYWdlZGlyIC4gJGZpbGVuYW1lKTsNCgkJJHJzID0gc2FmZV91cGRhdGUoJ3R4cF9pbWFnZScsICJ3ID0gJyIuJHdpZHRoLiInLCBoID0gJyIuJGhlaWdodC4iJyIsICJpZCA9ICRpZCIpOw0KCX0gZWxzZSB7DQoJCSRycyA9IHNhZmVfdXBkYXRlKCd0eHBfaW1hZ2UnLCAidGh1bWJuYWlsID0gJzEnIiwgImlkID0gJGlkIik7DQoJfQ0KCQ0KCWVjaG8gKCRmaWxlcmVzdWx0ICYmICRycykgPyAic3VjY2VzcyIgOiAnRVJST1IgJzsNCn0NCiI7czo0OiJ0eXBlIjtzOjE6IjEiO3M6MzoibWQ1IjtzOjMyOiI2NDNkM2NmYmU4NzQ4NDdiZGRmMjQxM2JhNTMxNDcwZSI7fQ==